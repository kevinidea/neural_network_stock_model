Current working directory
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin
source venv/bin/activate
which python3
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/bin/python3
Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
INFO:preprocess_data_nn.py:

Loading and preprocessing data...

DEBUG:preprocess_data_nn.py:      date  permno
0  1980-01   10006
1  1980-01   10057
2  1980-01   10103
3  1980-01   10137
4  1980-01   10145
DEBUG:preprocess_data_nn.py:--------------------------------------------------
INFO:main.py:preprocessed df: (2216189, 158)
INFO:preprocess_data_nn.py:

Applying secondary data preprocessing..

INFO:main.py:secondary preprocessed df: (2165515, 158)
INFO:main.py:df sample:    permno  gvkey   adatadate  fyear  sic2     spi       mve_f  ...     zerotrade      beta    betasq      rsq1  pricedelay   idiovol  pyear
0   10006   1010  12/31/1978   1978    37  0.0000  269.308500  ...  1.115306e-07  1.060420  1.124491  0.343408    0.029859  0.025576   1980
1   10057   1098  09/30/1978   1978    36  0.0000   97.372000  ...  6.199128e-08  1.526013  2.328716  0.307905    0.092667  0.037473   1980
2   10103   1012  10/31/1978   1978    33     NaN    1.697500  ...           NaN  1.759493  3.095816  0.096753    0.221851  0.087020   1980
3   10137   1279  12/31/1978   1978    49     NaN  537.524500  ...  9.726790e-08  0.492885  0.242936  0.189693    0.125777  0.017540   1980
4   10145   1300  12/31/1978   1978    99 -0.0031  805.633282  ...  6.190654e-08  1.139163  1.297691  0.279437    0.024228  0.031201   1980

[5 rows x 158 columns]
INFO:main.py:Train year start: 1980
INFO:main.py:Prediction data years: [1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
INFO:main.py:

Loop through all the prediction years and build optimized model for each year

INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983]
INFO:transform_data_nn.py:Train_data: (184330, 158)

INFO:transform_data_nn.py:Test data years: [1984]
INFO:transform_data_nn.py:Test_data: (50784, 158)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984]
INFO:transform_data_nn.py:Retrain_data: (235114, 158)

INFO:transform_data_nn.py:Prediction data years: [1985]
INFO:transform_data_nn.py:Prediction_data: (53526, 158)

INFO:main.py:

Generate X and y with train_data, test_data, retrain_data, and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([184330, 103])
            y_train_tf: torch.Size([184330])

            x_test_tf: torch.Size([50784, 103])
            y_test_tf: torch.Size([50784])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([235114, 103])
            y_retrain_tf: torch.Size([235114])

            x_prediction_tf: torch.Size([53526, 103])
            y_prediction_tf: torch.Size([53526])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([ 0.3502,  0.5646,  0.3374, -0.5022,  0.0529, -0.5300, -0.0226, -0.2438,
         0.1543,  0.1864, -0.9513, -0.0741, -0.4790, -0.1944,  0.0702,  0.0157,
        -0.4153,  0.1402,  0.0000,  0.6688, -0.3719,  0.0000,  0.0088,  0.1011,
         0.0262, -0.1816, -0.6910,  0.0000,  0.5859,  0.9703,  0.6153, -0.2049,
         0.3970,  0.0000, -0.5962, -0.2484,  0.1118,  0.1707,  0.1953, -1.1439,
        -0.3703, -0.2070,  0.2884, -0.1122,  0.0283, -0.6742, -0.1601, -0.1519,
        -0.6824, -0.3334, -0.0563,  0.9687, -0.2176,  0.0000,  0.0635, -0.4621,
        -0.9840, -0.2021, -0.7718, -0.1008,  0.1142, -0.7501, -0.4323, -0.2668,
        -0.2817, -0.5593,  0.2119, -0.0872, -0.2362, -0.4097, -0.7328, -0.3224,
         0.0000, -0.8428, -0.0180, -1.1550,  0.2559,  0.1448,  0.5110,  0.1767,
        -0.4251, -0.2114, -0.0166,  0.0000, -0.0774, -0.2011, -0.0629, -0.7467,
        -0.5108, -0.5048,  0.2351, -0.2889,  0.1580, -0.1287, -0.4961,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([3160]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-1.2105, -0.8788, -0.6071,  1.4063, -0.7269, -0.6021, -0.1685, -0.3657,
         0.4370,  0.1955, -1.0573, -0.1401, -0.5863, -0.0187,  0.0756, -0.0212,
        -0.7687, -0.7665,  0.0000, -1.0892,  0.7340,  0.0000,  0.0494, -0.9127,
        -0.7283,  0.0031, -0.7252,  0.0000,  1.3503,  1.6194, -1.3623, -0.6092,
         0.2458,  0.0000, -0.7539, -0.4939,  0.0533, -0.1973, -1.7392, -0.7787,
        -0.3739,  0.5433, -0.5025,  0.0280, -0.4474, -0.8582,  0.5707, -0.2911,
        -0.8946,  1.0834, -0.8029,  1.1376, -0.5508,  0.0000,  0.0635, -0.5669,
        -1.0148,  1.7723,  0.6710,  0.0918,  0.4306,  0.2224,  0.1687,  0.4315,
        -0.8319, -0.0367, -0.5062, -0.0900, -0.2362, -0.4129, -0.4616, -0.2910,
         0.0000, -1.1173, -0.8812, -0.5616, -0.7485,  0.0356, -1.6538,  0.0430,
        -0.4393, -0.1278,  1.3165,  0.0000, -0.8943, -0.2290,  0.6468,  1.2500,
        -0.3681, -0.4077, -1.0630, -0.4364, -1.2633,  0.2972, -0.4961,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  1.0000,  0.0000]), tensor([2032]), tensor(-0.0875))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([ 0.3435,  0.5761,  0.3075, -0.5679,  0.0524, -0.5320, -0.0215, -0.2454,
         0.2494,  0.1997, -0.9201, -0.0417, -0.4810, -0.1938,  0.0277,  0.0288,
        -0.4244,  0.1202,  0.0000,  0.7124, -0.3267,  0.0000, -0.0420, -0.0115,
         0.0181, -0.2026, -0.6904,  0.0000,  0.6153,  1.0531,  0.6410, -0.1841,
         0.4567,  0.0000, -0.5594, -0.2175,  0.1411,  0.1752,  0.1857, -1.1557,
        -0.3517, -0.0422,  0.3171, -0.0860,  0.0212, -0.6543, -0.0602, -0.1036,
        -0.6953, -0.2351, -0.1092,  0.9573, -0.2054,  0.0000,  0.0146, -0.4241,
        -0.9675, -0.2000, -0.7111, -0.1357,  0.0996, -0.7048, -0.4049, -0.2435,
        -0.2538, -0.5571,  0.1941, -0.0963, -0.2058, -0.4136, -0.7116, -0.3151,
         0.0000, -0.8244,  0.0178, -1.1900,  0.2651,  0.1931,  0.5434,  0.1858,
        -0.4328, -0.2078, -0.0359,  0.0000, -0.0501, -0.1408, -0.2109, -0.7138,
        -0.5070, -0.5073,  0.1884, -0.2900,  0.1628, -0.1251, -0.5137,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([3542]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([ 6.4261e-04,  1.2685e-02,  8.4677e+00, -1.8404e+00, -6.5494e-03,
         2.4014e-01,  1.8105e+00,  2.0869e+00, -9.5314e-01,  1.9096e-01,
         1.5033e+00, -8.8759e-02,  1.9129e-01,  2.4179e-01,  4.7970e-02,
         4.9506e-03, -4.0852e-02,  8.9596e-04,  0.0000e+00,  2.2276e-02,
        -8.3678e-02,  0.0000e+00, -4.5068e-02, -2.2208e-02, -2.6789e-01,
        -7.0162e-03, -2.7472e-01,  0.0000e+00, -1.2666e+00, -8.3659e-01,
         1.8794e+00, -1.3707e-02, -7.4838e-02,  0.0000e+00,  2.1095e-02,
         1.4292e-02,  1.7685e-02, -4.1131e-01, -1.9655e-03,  5.2790e-01,
        -1.6188e-01, -1.0328e+00,  1.7721e-02, -4.5017e-01, -3.5624e-03,
         1.6095e-01,  9.4023e-02,  1.4191e-01,  2.9990e-03, -8.6488e-01,
        -8.3277e-01, -6.6060e-01, -1.8350e-01,  0.0000e+00,  9.4917e-01,
         1.6069e-02,  3.3081e-02, -2.6253e-03, -2.9334e-02, -2.4389e-02,
         9.2416e-03, -3.5489e-02,  1.0408e-02,  7.0715e-03, -1.6132e-02,
         2.6242e-03, -6.5670e-03, -4.1979e-02,  1.0458e-02,  3.2092e-01,
        -1.1583e+00, -3.4773e-01,  0.0000e+00,  1.9125e-01,  1.0568e+00,
        -3.1215e-02,  6.2196e-01,  2.2528e-01,  2.0365e-01, -4.9071e-01,
         2.0586e+00,  6.6234e+00, -3.5912e-02,  0.0000e+00, -2.5086e-04,
        -5.6612e-01, -1.0866e+00, -6.9460e-01, -2.5999e-02, -2.6784e-02,
         2.3621e-02,  8.0345e-01,  4.4660e-01, -2.7241e-01, -5.1370e-01,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00]), tensor([4039]), tensor(0.3115))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983]
INFO:main.py:Testing data year: 1984
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 60
            max_num_epochs: 20
            num_cpus: 60
            cpus_per_trial: 1
            num_gpus: 2
            gpus_per_trial: 0
            continuous_dim: 102
            num_embeddings: 5102
            device: cuda
            
2024-07-03 23:43:27,857	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-03 23:43:27,891	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-03 23:43:27,913	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_cfb21e315b1af741.zip' (1.20MiB) to Ray cluster...
2024-07-03 23:43:27,917	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_cfb21e315b1af741.zip'.
2024-07-03 23:43:30,451	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-03 23:48:41,616	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-03_23-43-30' in 0.1686s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 102, 'hidden_dim': 65, 'num_layers': 3, 'num_embeddings': 5102, 'embedding_dim': 5, 'dropout_rate': 0.27180818453385097, 'lr': 0.00011948354480999256, 'weight_decay': 6.430385379260095e-06, 'num_epochs': 20, 'num_gpus': 2}
INFO:model_data_nn.py:Best trial training loss: 0.024693957997239106
INFO:model_data_nn.py:Best trial testing loss: 0.020620555682600444
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-03_23-43-25_382658_4067061/artifacts/2024-07-03_23-43-30/train_fnn_2024-07-03_23-43-30/driver_artifacts/train_fnn_0d614_00020_20_dropout_rate=0.2718,embedding_dim=5,hidden_dim=65,lr=0.0001,num_layers=3,weight_decay=0.0000_2024-07-03_23-43-30
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984]

            Using the optimized hyperparameters: {'continuous_dim': 102, 'hidden_dim': 65, 'num_layers': 3, 'num_embeddings': 5727, 'embedding_dim': 5, 'dropout_rate': 0.27180818453385097, 'lr': 0.00011948354480999256, 'weight_decay': 6.430385379260095e-06, 'num_epochs': 20, 'num_gpus': 2}

INFO:model_data_nn.py:Epoch 1/20, metrics: {'avg_train_loss': 25.956807614670673, 'avg_test_loss': 8.359476763763974}
INFO:model_data_nn.py:Epoch 2/20, metrics: {'avg_train_loss': 7.18918917175214, 'avg_test_loss': 2.304062517417644}
INFO:model_data_nn.py:Epoch 3/20, metrics: {'avg_train_loss': 2.043437473755786, 'avg_test_loss': 0.5038589642412054}
INFO:model_data_nn.py:Epoch 4/20, metrics: {'avg_train_loss': 0.38433896046117655, 'avg_test_loss': 0.07288047141864505}
INFO:model_data_nn.py:Epoch 5/20, metrics: {'avg_train_loss': 0.05439528846777631, 'avg_test_loss': 0.027496658992422367}
INFO:model_data_nn.py:Epoch 6/20, metrics: {'avg_train_loss': 0.024455493426069043, 'avg_test_loss': 0.025309514384361114}
INFO:model_data_nn.py:Epoch 7/20, metrics: {'avg_train_loss': 0.023817931858049052, 'avg_test_loss': 0.025417650613026928}
INFO:model_data_nn.py:Epoch 8/20, metrics: {'avg_train_loss': 0.023851392354672214, 'avg_test_loss': 0.025519521321283392}
INFO:model_data_nn.py:Epoch 9/20, metrics: {'avg_train_loss': 0.02385033096075788, 'avg_test_loss': 0.025301762679836276}
INFO:model_data_nn.py:Epoch 10/20, metrics: {'avg_train_loss': 0.02384880181730491, 'avg_test_loss': 0.02530127512802301}
INFO:model_data_nn.py:Epoch 11/20, metrics: {'avg_train_loss': 0.023850180185868906, 'avg_test_loss': 0.025216029444598283}
INFO:model_data_nn.py:Epoch 12/20, metrics: {'avg_train_loss': 0.02381418360256279, 'avg_test_loss': 0.025335109088045316}
INFO:model_data_nn.py:Epoch 13/20, metrics: {'avg_train_loss': 0.02376768610018894, 'avg_test_loss': 0.025250019628981345}
INFO:model_data_nn.py:Epoch 14/20, metrics: {'avg_train_loss': 0.023721636848389356, 'avg_test_loss': 0.025176989458065683}
INFO:model_data_nn.py:Epoch 15/20, metrics: {'avg_train_loss': 0.02367630792821255, 'avg_test_loss': 0.025466518408812245}
INFO:model_data_nn.py:Epoch 16/20, metrics: {'avg_train_loss': 0.023646302132374997, 'avg_test_loss': 0.02578485802456132}
INFO:model_data_nn.py:Epoch 17/20, metrics: {'avg_train_loss': 0.02361653247421276, 'avg_test_loss': 0.02541704228712437}
INFO:model_data_nn.py:Epoch 18/20, metrics: {'avg_train_loss': 0.023608935313480798, 'avg_test_loss': 0.025266265936711524}
INFO:model_data_nn.py:Epoch 19/20, metrics: {'avg_train_loss': 0.02355568633842189, 'avg_test_loss': 0.025303843832376962}
INFO:model_data_nn.py:Epoch 20/20, metrics: {'avg_train_loss': 0.02356010950669833, 'avg_test_loss': 0.02567827310479804}
INFO:main.py:Making prediction for data in year: 1984
INFO:main.py:Prediction data shape: (53526,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:372: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1985: 0.16020993478932408
INFO:main.py:Prediction Stats:                 ret          pred
count  53526.000000  53526.000000
mean       0.018898      0.014966
std        0.158638      0.030567
min       -0.850000     -0.280916
25%       -0.055112      0.007197
50%        0.002178      0.016560
75%        0.077120      0.026708
max        4.666667      0.341990
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984]
INFO:transform_data_nn.py:Train_data: (235114, 158)

INFO:transform_data_nn.py:Test data years: [1985]
INFO:transform_data_nn.py:Test_data: (53526, 158)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985]
INFO:transform_data_nn.py:Retrain_data: (288640, 158)

INFO:transform_data_nn.py:Prediction data years: [1986]
INFO:transform_data_nn.py:Prediction_data: (53143, 158)

INFO:main.py:

Generate X and y with train_data, test_data, retrain_data, and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([235114, 103])
            y_train_tf: torch.Size([235114])

            x_test_tf: torch.Size([53526, 103])
            y_test_tf: torch.Size([53526])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([288640, 103])
            y_retrain_tf: torch.Size([288640])

            x_prediction_tf: torch.Size([53143, 103])
            y_prediction_tf: torch.Size([53143])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([ 0.3435,  0.5761,  0.3075, -0.5679,  0.0524, -0.5320, -0.0215, -0.2454,
         0.2494,  0.1997, -0.9201, -0.0417, -0.4810, -0.1938,  0.0277,  0.0288,
        -0.4244,  0.1202,  0.0000,  0.7124, -0.3267,  0.0000, -0.0420, -0.0115,
         0.0181, -0.2026, -0.6904,  0.0000,  0.6153,  1.0531,  0.6410, -0.1841,
         0.4567,  0.0000, -0.5594, -0.2175,  0.1411,  0.1752,  0.1857, -1.1557,
        -0.3517, -0.0422,  0.3171, -0.0860,  0.0212, -0.6543, -0.0602, -0.1036,
        -0.6953, -0.2351, -0.1092,  0.9573, -0.2054,  0.0000,  0.0146, -0.4241,
        -0.9675, -0.2000, -0.7111, -0.1357,  0.0996, -0.7048, -0.4049, -0.2435,
        -0.2538, -0.5571,  0.1941, -0.0963, -0.2058, -0.4136, -0.7116, -0.3151,
         0.0000, -0.8244,  0.0178, -1.1900,  0.2651,  0.1931,  0.5434,  0.1858,
        -0.4328, -0.2078, -0.0359,  0.0000, -0.0501, -0.1408, -0.2109, -0.7138,
        -0.5070, -0.5073,  0.1884, -0.2900,  0.1628, -0.1251, -0.5137,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([3542]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 6.4261e-04,  1.2685e-02,  8.4677e+00, -1.8404e+00, -6.5494e-03,
         2.4014e-01,  1.8105e+00,  2.0869e+00, -9.5314e-01,  1.9096e-01,
         1.5033e+00, -8.8759e-02,  1.9129e-01,  2.4179e-01,  4.7970e-02,
         4.9506e-03, -4.0852e-02,  8.9596e-04,  0.0000e+00,  2.2276e-02,
        -8.3678e-02,  0.0000e+00, -4.5068e-02, -2.2208e-02, -2.6789e-01,
        -7.0162e-03, -2.7472e-01,  0.0000e+00, -1.2666e+00, -8.3659e-01,
         1.8794e+00, -1.3707e-02, -7.4838e-02,  0.0000e+00,  2.1095e-02,
         1.4292e-02,  1.7685e-02, -4.1131e-01, -1.9655e-03,  5.2790e-01,
        -1.6188e-01, -1.0328e+00,  1.7721e-02, -4.5017e-01, -3.5624e-03,
         1.6095e-01,  9.4023e-02,  1.4191e-01,  2.9990e-03, -8.6488e-01,
        -8.3277e-01, -6.6060e-01, -1.8350e-01,  0.0000e+00,  9.4917e-01,
         1.6069e-02,  3.3081e-02, -2.6253e-03, -2.9334e-02, -2.4389e-02,
         9.2416e-03, -3.5489e-02,  1.0408e-02,  7.0715e-03, -1.6132e-02,
         2.6242e-03, -6.5670e-03, -4.1979e-02,  1.0458e-02,  3.2092e-01,
        -1.1583e+00, -3.4773e-01,  0.0000e+00,  1.9125e-01,  1.0568e+00,
        -3.1215e-02,  6.2196e-01,  2.2528e-01,  2.0365e-01, -4.9071e-01,
         2.0586e+00,  6.6234e+00, -3.5912e-02,  0.0000e+00, -2.5086e-04,
        -5.6612e-01, -1.0866e+00, -6.9460e-01, -2.5999e-02, -2.6784e-02,
         2.3621e-02,  8.0345e-01,  4.4660e-01, -2.7241e-01, -5.1370e-01,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00]), tensor([4039]), tensor(0.3115))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([ 0.2960,  0.5291,  0.2580, -0.5988,  0.0395, -0.5259, -0.0249, -0.2506,
         0.3278,  0.2032, -0.8957, -0.0173, -0.4977, -0.1929,  0.0055,  0.0193,
        -0.4292,  0.1097,  0.0000,  0.6755, -0.3619,  0.0000,  0.0051,  0.0066,
         0.0301, -0.2162, -0.6888,  0.0000,  0.6148,  1.1238,  0.6377, -0.1689,
         0.4858,  0.0000, -0.5416, -0.2104,  0.1443,  0.1836,  0.1264, -1.1581,
        -0.3292,  0.0282,  0.3104, -0.0624, -0.0053, -0.6454, -0.0189, -0.1052,
        -0.7206, -0.2245, -0.1447,  0.9449, -0.1909,  0.0000,  0.0151, -0.4011,
        -0.9564, -0.0779, -0.6553, -0.1434,  0.0978, -0.6593, -0.3653, -0.2155,
        -0.2687, -0.5474,  0.1388, -0.1024, -0.2127, -0.4138, -0.7152, -0.3087,
        -0.2357, -0.8090,  0.0576, -1.1741,  0.2740,  0.2193,  0.5585,  0.1815,
        -0.4377, -0.2044, -0.0167,  0.0000, -0.0722, -0.0912, -0.2897, -0.6977,
        -0.5085, -0.5068,  0.1836, -0.2903,  0.1703, -0.1403, -0.5231,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([3844]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-5.2024e-01, -1.4298e-01, -6.9860e-01, -1.3580e+00, -2.1218e-02,
        -4.3693e-01,  1.3244e+00,  1.3047e+00, -4.0142e-01,  2.0489e-01,
         5.7447e-03,  2.9823e-01,  1.2066e-01, -5.8988e-02,  8.1931e-03,
         4.3817e-03, -4.3869e-01, -2.4638e-01,  0.0000e+00, -1.1026e-01,
        -2.8431e-01,  0.0000e+00, -7.6915e-02,  4.3407e-01,  5.6338e+00,
        -6.4075e-01, -3.8804e-01,  0.0000e+00,  2.6990e-01, -8.0007e-01,
         3.0559e-03, -2.3573e-02,  1.6926e-01,  0.0000e+00,  3.9212e+00,
        -2.8485e-03,  2.4843e+00, -4.5319e-01,  9.3834e-02,  2.6323e-01,
        -3.2894e-01, -4.5149e-01,  1.4662e+00, -3.8584e-01, -1.0827e-01,
        -1.5566e-01,  2.3228e+00,  3.7301e-01,  3.6370e-02,  1.1725e+00,
         1.9850e+00, -9.7385e-02, -1.7884e-01,  0.0000e+00,  9.2012e-01,
         2.4478e+00,  2.5280e+00, -1.3598e-02, -1.5963e+00, -3.8572e-01,
         4.6115e-02, -1.4525e+00, -5.5158e-01,  1.2253e+00,  9.1787e-03,
        -6.3798e-01, -2.3351e-01, -2.6916e-01, -2.1275e-01, -4.1505e-01,
        -2.0565e-02, -3.7904e-02,  8.2735e+00, -6.8355e-01,  9.9116e-01,
        -4.8114e-02,  6.1614e-01,  1.8687e-01,  1.3681e-01, -3.6534e-01,
         1.5624e+00,  5.6475e+00, -1.6681e-02,  0.0000e+00,  1.4041e-01,
        -2.3662e-01,  1.0028e+00,  2.1421e+00, -3.3921e-02, -3.3130e-02,
         1.2762e-01, -1.4161e-01,  1.0862e-01,  5.5329e-01, -5.2307e-01,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00]), tensor([4033]), tensor(0.))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984]
INFO:main.py:Testing data year: 1985
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 60
            max_num_epochs: 20
            num_cpus: 60
            cpus_per_trial: 1
            num_gpus: 2
            gpus_per_trial: 0
            continuous_dim: 102
            num_embeddings: 5727
            device: cuda
            
2024-07-04 00:21:05,276	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-04 00:21:05,301	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-04 00:21:05,321	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_cfb21e315b1af741.zip' (1.20MiB) to Ray cluster...
2024-07-04 00:21:05,325	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_cfb21e315b1af741.zip'.
2024-07-04 00:21:08,739	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-04 00:29:01,894	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-04_00-21-08' in 0.1483s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 102, 'hidden_dim': 45, 'num_layers': 5, 'num_embeddings': 5727, 'embedding_dim': 20, 'dropout_rate': 0.3425596287705535, 'lr': 0.0006786952562305604, 'weight_decay': 0.0006803850954616791, 'num_epochs': 20, 'num_gpus': 2}
INFO:model_data_nn.py:Best trial training loss: 0.023585725559969115
INFO:model_data_nn.py:Best trial testing loss: 0.025148285568418395
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-04_00-21-02_714601_4067061/artifacts/2024-07-04_00-21-08/train_fnn_2024-07-04_00-21-08/driver_artifacts/train_fnn_4f722_00054_54_dropout_rate=0.3426,embedding_dim=20,hidden_dim=45,lr=0.0007,num_layers=5,weight_decay=0.0007_2024-07-04_00-21-09
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985]

            Using the optimized hyperparameters: {'continuous_dim': 102, 'hidden_dim': 45, 'num_layers': 5, 'num_embeddings': 6222, 'embedding_dim': 20, 'dropout_rate': 0.3425596287705535, 'lr': 0.0006786952562305604, 'weight_decay': 0.0006803850954616791, 'num_epochs': 20, 'num_gpus': 2}

INFO:model_data_nn.py:Epoch 1/20, metrics: {'avg_train_loss': 10.21516802146403, 'avg_test_loss': 0.12763556227302894}
INFO:model_data_nn.py:Epoch 2/20, metrics: {'avg_train_loss': 0.07853845574473858, 'avg_test_loss': 0.034365088578152396}
INFO:model_data_nn.py:Epoch 3/20, metrics: {'avg_train_loss': 0.02507426445300127, 'avg_test_loss': 0.030278103188790668}
INFO:model_data_nn.py:Epoch 4/20, metrics: {'avg_train_loss': 0.02437964262618392, 'avg_test_loss': 0.029872827243077785}
INFO:model_data_nn.py:Epoch 5/20, metrics: {'avg_train_loss': 0.024645088186400824, 'avg_test_loss': 0.029821548787787415}
INFO:model_data_nn.py:Epoch 6/20, metrics: {'avg_train_loss': 0.024554811964872934, 'avg_test_loss': 0.029748309582758408}
INFO:model_data_nn.py:Epoch 7/20, metrics: {'avg_train_loss': 0.024206896685889847, 'avg_test_loss': 0.029734574670258623}
INFO:model_data_nn.py:Epoch 8/20, metrics: {'avg_train_loss': 0.02402838186429041, 'avg_test_loss': 0.029636091102684777}
INFO:model_data_nn.py:Epoch 9/20, metrics: {'avg_train_loss': 0.023886115808956773, 'avg_test_loss': 0.02961663064958814}
INFO:model_data_nn.py:Epoch 10/20, metrics: {'avg_train_loss': 0.023886910539756463, 'avg_test_loss': 0.02973505584164881}
INFO:model_data_nn.py:Epoch 11/20, metrics: {'avg_train_loss': 0.02388897824231246, 'avg_test_loss': 0.02960084591177292}
INFO:model_data_nn.py:Epoch 12/20, metrics: {'avg_train_loss': 0.023896000671826154, 'avg_test_loss': 0.029582257187799908}
INFO:model_data_nn.py:Epoch 13/20, metrics: {'avg_train_loss': 0.02389461685864135, 'avg_test_loss': 0.02962004663109278}
INFO:model_data_nn.py:Epoch 14/20, metrics: {'avg_train_loss': 0.023897745151345323, 'avg_test_loss': 0.029614421389011953}
INFO:model_data_nn.py:Epoch 15/20, metrics: {'avg_train_loss': 0.023894347220312334, 'avg_test_loss': 0.02961333186025373}
INFO:model_data_nn.py:Epoch 16/20, metrics: {'avg_train_loss': 0.02389512906995026, 'avg_test_loss': 0.029625485147474907}
INFO:model_data_nn.py:Epoch 17/20, metrics: {'avg_train_loss': 0.023889358423468544, 'avg_test_loss': 0.02959353868321229}
INFO:model_data_nn.py:Epoch 18/20, metrics: {'avg_train_loss': 0.023889100795277205, 'avg_test_loss': 0.02963523562021482}
INFO:model_data_nn.py:Epoch 19/20, metrics: {'avg_train_loss': 0.023889939451049145, 'avg_test_loss': 0.029542792319821622}
INFO:model_data_nn.py:Epoch 20/20, metrics: {'avg_train_loss': 0.023888532027701317, 'avg_test_loss': 0.029619919445114926}
INFO:main.py:Making prediction for data in year: 1985
INFO:main.py:Prediction data shape: (53143,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:372: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1986: 0.17219879596758123
INFO:main.py:Prediction Stats:                 ret          pred
count  53143.000000  53143.000000
mean       0.006707      0.016346
std        0.172102      0.006345
min       -0.808824     -0.027580
25%       -0.074074      0.011021
50%        0.000000      0.016192
75%        0.069307      0.021240
max       10.200000      0.043274
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985]
INFO:transform_data_nn.py:Train_data: (288640, 158)

INFO:transform_data_nn.py:Test data years: [1986]
INFO:transform_data_nn.py:Test_data: (53143, 158)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986]
INFO:transform_data_nn.py:Retrain_data: (341783, 158)

INFO:transform_data_nn.py:Prediction data years: [1987]
INFO:transform_data_nn.py:Prediction_data: (53899, 158)

INFO:main.py:

Generate X and y with train_data, test_data, retrain_data, and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([288640, 103])
            y_train_tf: torch.Size([288640])

            x_test_tf: torch.Size([53143, 103])
            y_test_tf: torch.Size([53143])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([341783, 103])
            y_retrain_tf: torch.Size([341783])

            x_prediction_tf: torch.Size([53899, 103])
            y_prediction_tf: torch.Size([53899])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([ 0.2960,  0.5291,  0.2580, -0.5988,  0.0395, -0.5259, -0.0249, -0.2506,
         0.3278,  0.2032, -0.8957, -0.0173, -0.4977, -0.1929,  0.0055,  0.0193,
        -0.4292,  0.1097,  0.0000,  0.6755, -0.3619,  0.0000,  0.0051,  0.0066,
         0.0301, -0.2162, -0.6888,  0.0000,  0.6148,  1.1238,  0.6377, -0.1689,
         0.4858,  0.0000, -0.5416, -0.2104,  0.1443,  0.1836,  0.1264, -1.1581,
        -0.3292,  0.0282,  0.3104, -0.0624, -0.0053, -0.6454, -0.0189, -0.1052,
        -0.7206, -0.2245, -0.1447,  0.9449, -0.1909,  0.0000,  0.0151, -0.4011,
        -0.9564, -0.0779, -0.6553, -0.1434,  0.0978, -0.6593, -0.3653, -0.2155,
        -0.2687, -0.5474,  0.1388, -0.1024, -0.2127, -0.4138, -0.7152, -0.3087,
        -0.2357, -0.8090,  0.0576, -1.1741,  0.2740,  0.2193,  0.5585,  0.1815,
        -0.4377, -0.2044, -0.0167,  0.0000, -0.0722, -0.0912, -0.2897, -0.6977,
        -0.5085, -0.5068,  0.1836, -0.2903,  0.1703, -0.1403, -0.5231,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([3844]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-5.2024e-01, -1.4298e-01, -6.9860e-01, -1.3580e+00, -2.1218e-02,
        -4.3693e-01,  1.3244e+00,  1.3047e+00, -4.0142e-01,  2.0489e-01,
         5.7447e-03,  2.9823e-01,  1.2066e-01, -5.8988e-02,  8.1931e-03,
         4.3817e-03, -4.3869e-01, -2.4638e-01,  0.0000e+00, -1.1026e-01,
        -2.8431e-01,  0.0000e+00, -7.6915e-02,  4.3407e-01,  5.6338e+00,
        -6.4075e-01, -3.8804e-01,  0.0000e+00,  2.6990e-01, -8.0007e-01,
         3.0559e-03, -2.3573e-02,  1.6926e-01,  0.0000e+00,  3.9212e+00,
        -2.8485e-03,  2.4843e+00, -4.5319e-01,  9.3834e-02,  2.6323e-01,
        -3.2894e-01, -4.5149e-01,  1.4662e+00, -3.8584e-01, -1.0827e-01,
        -1.5566e-01,  2.3228e+00,  3.7301e-01,  3.6370e-02,  1.1725e+00,
         1.9850e+00, -9.7385e-02, -1.7884e-01,  0.0000e+00,  9.2012e-01,
         2.4478e+00,  2.5280e+00, -1.3598e-02, -1.5963e+00, -3.8572e-01,
         4.6115e-02, -1.4525e+00, -5.5158e-01,  1.2253e+00,  9.1787e-03,
        -6.3798e-01, -2.3351e-01, -2.6916e-01, -2.1275e-01, -4.1505e-01,
        -2.0565e-02, -3.7904e-02,  8.2735e+00, -6.8355e-01,  9.9116e-01,
        -4.8114e-02,  6.1614e-01,  1.8687e-01,  1.3681e-01, -3.6534e-01,
         1.5624e+00,  5.6475e+00, -1.6681e-02,  0.0000e+00,  1.4041e-01,
        -2.3662e-01,  1.0028e+00,  2.1421e+00, -3.3921e-02, -3.3130e-02,
         1.2762e-01, -1.4161e-01,  1.0862e-01,  5.5329e-01, -5.2307e-01,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00]), tensor([4033]), tensor(0.))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([ 0.2614,  0.5034,  0.2386, -0.6303,  0.0469, -0.5241, -0.0284, -0.2584,
         0.3866,  0.1910, -0.8830,  0.0062, -0.5088, -0.1862, -0.0053,  0.0250,
        -0.4235,  0.1175,  0.0000,  0.6719, -0.3586,  0.0000,  0.0257,  0.0166,
         0.0370, -0.2229, -0.6756,  0.0000,  0.5764,  1.1873,  0.6227, -0.1414,
         0.5064,  0.0000, -0.5226, -0.2165,  0.1496,  0.1907,  0.1020, -1.1512,
        -0.3211,  0.0239,  0.3191, -0.0440, -0.0208, -0.6509, -0.0216, -0.0993,
        -0.6609, -0.2278, -0.1547,  0.9190, -0.1748,  0.0000,  0.0265, -0.3809,
        -0.9466, -0.0875, -0.6362, -0.1616,  0.1008, -0.6415, -0.3684, -0.1993,
        -0.2698, -0.5237,  0.0996, -0.1018, -0.1900, -0.4132, -0.7240, -0.3249,
         0.0346, -0.8136,  0.1052, -1.0783,  0.2870,  0.2369,  0.6056,  0.1760,
        -0.4392, -0.2020, -0.0110,  0.0000, -0.0826, -0.0538, -0.3134, -0.6841,
        -0.4092, -0.4207,  0.1949, -0.2766,  0.1496, -0.1756, -0.5206,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([4108]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-6.9920e-03,  8.9557e-03, -3.4033e-01, -1.6683e+00,  4.0069e-03,
         1.0097e+00, -2.5891e-03, -1.0957e-02, -9.5448e-01,  1.8591e-01,
         3.8505e-01,  6.2086e-01,  1.9972e-01,  2.1500e-02, -2.2037e-05,
         6.4081e-03, -7.8682e-03,  1.2509e-02,  0.0000e+00,  2.2175e-02,
        -7.5173e-02,  0.0000e+00, -1.5533e-02,  1.2460e-02,  3.1036e-02,
         1.3005e-01, -2.3377e-01,  0.0000e+00, -4.6695e-01, -7.7328e-01,
        -6.6426e-01,  6.0568e-03, -1.6879e-02,  0.0000e+00,  1.5509e-02,
        -1.9876e-03,  9.2778e-03, -4.6920e-01,  6.8878e-04, -2.7767e-02,
        -1.1036e-01, -6.2118e-01,  1.3711e-02, -4.6129e-01, -4.5306e-03,
         2.2998e+00,  1.6293e-02, -1.3041e+00,  5.4224e-02, -1.1150e-03,
        -8.5550e-01, -1.1288e+00, -3.1813e-01,  0.0000e+00, -8.7597e-01,
         1.4499e-02,  3.0605e-02,  1.3658e-02, -8.7689e-03, -1.7061e-02,
         1.2506e-02, -1.1364e-02, -2.6022e-03,  1.5424e-03, -6.5274e-04,
        -7.4535e-03, -6.8802e-03, -2.2825e-02,  2.5533e-02,  1.5004e-01,
        -1.1726e-02, -2.4365e-02,  3.4575e-02,  1.6018e+00, -3.4779e+00,
        -7.2764e-02, -2.0625e+00,  4.1949e-01, -3.2436e-01, -4.6815e-01,
        -4.0800e-01, -3.1863e-01,  1.6746e+00,  0.0000e+00, -3.2632e-03,
        -6.4726e-01,  8.8510e-02,  5.2651e-01, -4.4860e-02, -4.4852e-02,
        -2.1688e-01,  1.4353e+00,  1.8772e-01,  3.0461e-01, -5.2065e-01,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00]), tensor([1520]), tensor(-0.5200))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985]
INFO:main.py:Testing data year: 1986
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 60
            max_num_epochs: 20
            num_cpus: 60
            cpus_per_trial: 1
            num_gpus: 2
            gpus_per_trial: 0
            continuous_dim: 102
            num_embeddings: 6222
            device: cuda
            
2024-07-04 01:10:30,388	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-04 01:10:30,413	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-04 01:10:30,434	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_cfb21e315b1af741.zip' (1.20MiB) to Ray cluster...
2024-07-04 01:10:30,441	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_cfb21e315b1af741.zip'.
2024-07-04 01:10:32,774	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
