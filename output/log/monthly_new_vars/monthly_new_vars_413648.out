Current working directory
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml
source kevin/venv/bin/activate
which python3
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/bin/python3
2024-07-10 01:13:57,045	PANIC scripts.py:900 -- `--address` is a required flag unless starting a head node with `--head`.
Error: `{}` is a required flag unless starting a head node with `{}`.
Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
INFO:preprocess_data_nn.py:

Loading and preprocessing data...

DEBUG:preprocess_data_nn.py:          date   permno
626    1980-01  10006.0
5399   1980-01  10057.0
11398  1980-01  10137.0
12828  1980-01  10145.0
13984  1980-01  10153.0
DEBUG:preprocess_data_nn.py:--------------------------------------------------
INFO:main.py:preprocessed df: (2005900, 161)
INFO:preprocess_data_nn.py:

Applying secondary data preprocessing..

INFO:main.py:secondary preprocessed df: (1942951, 161)
INFO:main.py:df sample:     permno       pdate        ym  gvkey  sic2    absacc       acc    aeavol  ...      roaa      roea   roavola       ret        mve_m      retq  pyear     date
0  10006.0  1980-01-01  198001.0   1010    37  0.083420  0.083420  1.001090  ...  0.048684  0.141715  0.004512  0.211679   303420.750 -0.055806   1980  1980-01
1  10057.0  1980-01-01  198001.0   1098    36  0.088951  0.088951 -0.613146  ...  0.092434  0.174252  0.035698  0.282297   111423.125 -0.069431   1980  1980-01
2  10137.0  1980-01-01  198001.0   1279    49  0.041008  0.041008 -0.491307  ...  0.034895  0.097554  0.006254 -0.032258   617349.500 -0.108065   1980  1980-01
3  10145.0  1980-01-01  198001.0   1300    99  0.050486  0.050486 -0.256932  ...  0.049028  0.122729  0.004320  0.150127  1415193.000 -0.085950   1980  1980-01
4  10153.0  1980-01-01  198001.0   1308    13       NaN       NaN  1.631801  ...  0.049860  0.109950  0.009149 -0.122744   429488.500 -0.285199   1980  1980-01

[5 rows x 161 columns]
INFO:main.py:Train year start: 1980
INFO:main.py:Prediction data years: [1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020]
INFO:main.py:

Loop through all the prediction years and build optimized model for each year

INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986]
INFO:transform_data_nn.py:Train_data: (237147, 161)

INFO:transform_data_nn.py:Test data years: [1987]
INFO:transform_data_nn.py:Test_data: (44352, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987]
INFO:transform_data_nn.py:Retrain_data: (281499, 161)

INFO:transform_data_nn.py:Prediction data years: [1988]
INFO:transform_data_nn.py:Prediction_data: (46885, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([237147, 152])
            y_train_tf: torch.Size([237147])

            x_test_tf: torch.Size([44352, 152])
            y_test_tf: torch.Size([44352])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([281499, 152])
            y_retrain_tf: torch.Size([281499])

            x_prediction_tf: torch.Size([46885, 152])
            y_prediction_tf: torch.Size([46885])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-0.1378,  0.2011,  0.1735, -1.2736, -0.1414, -0.6129, -0.1248, -0.3115,
         0.2968, -0.1604, -0.7119, -0.1284, -0.4702, -0.0566,  0.0624,  0.5452,
        -0.1485,  0.1085,  0.0000,  0.4475, -0.3672, -0.2125,  0.0325,  0.0146,
        -0.0833, -0.2362, -0.5806,  0.0000,  0.3954,  0.8854,  0.4877, -0.1312,
         0.4150,  0.0000, -0.4067, -0.2013,  0.0756,  0.4689,  0.0805, -1.1706,
        -0.2576,  0.0846,  0.1459, -0.0784, -0.1491, -0.6672, -0.0211, -0.1119,
        -0.5597, -0.2513, -0.6202,  0.6533, -0.1762, -0.0731,  0.0316,  0.4455,
        -0.7773, -0.0479, -0.2733,  0.0933,  0.1035, -0.3434,  0.1623,  0.2965,
         0.2079, -0.1035,  0.0400, -0.0618,  0.7032, -0.4171,  0.0000,  0.0000,
         0.0282, -0.8190, -0.0195,  0.5824,  0.0410, -0.3436, -0.1796, -0.0104,
         0.0000,  0.3771,  0.0150, -0.2020, -0.5611, -0.0783, -0.0633, -0.3700,
        -0.1631,  0.1329, -0.5081, -1.2896,  0.2434,  1.0516,  1.6154,  1.4313,
         0.4921,  1.0178, -2.2250, -0.7145, -1.0838,  0.1765,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0681,  0.1245,  0.0000, -1.6484, -0.1374, -1.7709,
         0.1165,  0.0567,  0.0000,  0.0000,  0.0141, -0.1652, -0.0921,  0.0665,
         0.2107, -0.4339, -0.4025,  0.1455,  0.2247, -0.3825,  0.0000,  0.0000,
         0.0000,  1.0000,  1.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([1470]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 1.8020e+00,  1.9152e+00,  3.4486e-01, -1.8913e-01,  1.3689e+00,
         2.6924e+00, -8.9300e-01, -7.8639e-01, -4.9107e-01, -6.5433e-01,
        -5.3155e-01, -1.2724e-01,  2.2762e-01, -3.8230e-01,  1.8586e+00,
         2.3049e+00, -2.2689e-01,  3.8296e+00,  0.0000e+00,  3.2700e+00,
         5.0575e-03, -2.1251e-01,  2.0621e-02, -2.5567e-03,  6.3772e-02,
         1.0327e+00,  2.0287e+00,  0.0000e+00, -1.3956e+00, -8.2966e-01,
        -4.6975e-01, -1.4919e-01,  4.2877e-02,  0.0000e+00,  1.2218e+00,
        -2.0587e-01,  2.0151e-01,  5.4386e-01,  4.6245e+00, -5.7104e-01,
         3.3704e-01, -5.3257e-01,  2.2907e+00, -3.5756e-01,  2.8893e+00,
        -1.0363e+00, -2.0763e-01, -1.0985e+00, -6.9351e-01,  1.0851e-01,
        -6.2015e-01, -1.1060e+00, -1.3256e-01, -7.3100e-02, -7.3521e-01,
         4.8096e-02,  1.0329e+00, -3.2643e-01,  6.0915e-01,  3.3914e+00,
         1.9910e-01,  6.6620e-01,  8.5977e-01,  5.6841e-01, -1.9664e+00,
         3.9913e-01,  1.1799e+00, -6.0768e-01, -1.2768e+00, -3.7900e-01,
         0.0000e+00,  0.0000e+00,  2.8222e-02, -6.5080e-01, -1.0827e-01,
         1.6211e+00, -7.8200e-02, -3.9600e-01,  2.2145e-01, -9.8606e-01,
         0.0000e+00,  2.3511e+00, -2.7285e-01,  1.9970e+00, -6.8303e-02,
        -4.8069e-02, -4.9363e-02, -3.5668e-01, -2.2977e-01, -1.3200e-01,
        -6.0629e-01,  3.0339e+00,  2.4336e-01, -1.5991e+00, -1.6971e+00,
        -1.5188e+00, -6.1921e-01, -1.3641e+00,  1.8554e-01, -2.9779e-01,
        -3.4293e-01,  1.8998e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.6694e-02,  1.2451e-01,  0.0000e+00,  7.3645e-01,
        -1.3529e+00,  3.0857e-01, -2.1738e-02,  5.6721e-02,  0.0000e+00,
         0.0000e+00,  2.7793e+00,  5.4316e-01, -9.2059e-02,  3.3375e-01,
         1.7586e+00,  4.1795e-01, -6.4637e-02,  4.0987e-03,  4.2907e-02,
         3.3521e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1111]), tensor(0.0417))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.6485e-01,  1.8230e-01,  1.7097e-01, -1.2895e+00, -1.4861e-01,
        -6.3361e-01, -1.3953e-01, -3.2412e-01,  3.5052e-01, -1.6415e-01,
        -7.1298e-01, -8.7418e-02, -4.8984e-01, -2.8638e-02,  5.3805e-02,
         5.3585e-01, -1.5057e-01,  1.4105e-01,  0.0000e+00,  4.4826e-01,
        -3.6039e-01, -2.0729e-02,  2.5868e-02,  2.6469e-03, -6.5325e-02,
        -2.4458e-01, -5.7430e-01,  0.0000e+00,  3.6729e-01,  9.5292e-01,
         4.8242e-01, -1.2829e-01,  4.3593e-01,  0.0000e+00, -3.9010e-01,
        -1.9800e-01,  7.8118e-02,  4.8214e-01,  6.1557e-02, -1.1636e+00,
        -2.6444e-01,  1.3808e-01,  1.6335e-01, -6.4053e-02, -1.6169e-01,
        -6.7458e-01,  5.4317e-03, -7.7477e-02, -5.5695e-01, -2.3816e-01,
        -6.2338e-01,  6.4888e-01, -1.6650e-01, -1.9579e-03,  2.7732e-02,
         4.4700e-01, -7.7374e-01, -1.7885e-02, -2.7024e-01,  5.4831e-02,
         1.0554e-01, -3.3980e-01,  1.6083e-01,  2.9301e-01,  1.9625e-01,
        -1.0893e-01,  1.9625e-02, -6.5275e-02,  7.2753e-01, -4.1686e-01,
         0.0000e+00,  0.0000e+00, -1.7687e-02, -8.1674e-01,  1.3622e-02,
         6.0146e-01,  4.2794e-02, -3.4357e-01, -1.8006e-01, -1.1661e-02,
         0.0000e+00,  3.4367e-01,  5.3540e-02, -2.1577e-01, -5.6823e-01,
        -8.4531e-02, -6.9139e-02, -3.6387e-01, -1.5407e-01,  1.0011e-01,
        -5.2393e-01, -1.2947e+00,  1.1243e-01,  1.0997e+00,  1.5975e+00,
         1.5071e+00,  5.2009e-01,  1.1836e+00, -2.4439e+00, -5.6879e-01,
        -2.7414e-01,  1.5649e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.1913e-02, -4.5387e-02,  0.0000e+00, -1.7755e+00,
         4.2778e-02, -1.9666e+00,  1.2646e-01,  9.4528e-02,  0.0000e+00,
         0.0000e+00,  2.1740e-02, -1.7337e-01, -8.7121e-02,  3.3313e-02,
         1.9914e-01, -4.1977e-01, -3.9246e-01,  1.7793e-01,  2.3912e-01,
        -3.9531e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1644]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-1.1594e-02, -5.2073e-03, -6.3248e-01, -8.0822e-01, -7.0266e-01,
        -1.4151e-01, -1.8634e+00, -1.0292e+00, -8.8950e-03,  9.8507e-03,
        -3.5172e-01, -2.3780e-01,  5.1335e-02, -3.8287e-03,  3.3370e-02,
        -1.4351e+00, -2.2808e-01, -1.2205e-01,  0.0000e+00, -2.4636e-01,
         3.8865e-01, -2.0729e-02,  8.3911e-03,  3.7377e-02,  7.5325e-03,
        -6.3693e-01, -7.4307e-01,  0.0000e+00, -7.7996e-01,  3.6407e-02,
        -9.5491e-01, -3.4028e-01,  4.7802e-02,  0.0000e+00, -2.4158e+00,
         7.5641e-03, -6.2660e-01, -6.6273e-01, -2.9067e-01, -7.8528e-01,
         6.4925e-01, -9.4471e-01, -5.3122e-01, -1.8937e-01,  1.4665e-02,
        -1.4826e-01, -5.0533e-01, -3.3594e-01, -2.8811e-01, -7.2144e-03,
         1.2393e-01, -1.4796e+00, -4.8504e-01, -1.9579e-03, -7.4145e-01,
        -1.6221e+00, -1.0965e+00, -3.7581e-01, -5.2418e-02,  1.4472e-02,
        -2.8946e+00, -4.9031e-02, -8.8467e-02, -5.0532e+00, -9.7408e-03,
        -3.8957e-01, -1.0467e-02,  1.8309e+00, -5.8154e-01, -3.6450e-01,
         0.0000e+00,  0.0000e+00, -1.7687e-02,  8.9230e-02, -1.9116e-01,
        -2.3047e-01, -1.4984e-01,  3.2335e+00, -2.0202e-01, -1.1661e-02,
         0.0000e+00, -1.0029e+00, -2.6086e-02,  2.4173e+00,  3.8172e+00,
        -7.2883e-02, -6.3519e-02, -2.3079e-01,  6.0293e-01, -2.8818e-01,
         7.5226e-01,  5.6420e-01,  1.1243e-01, -7.3275e-01, -5.6379e-01,
        -1.0268e+00,  6.7123e-01, -1.0431e+00,  7.4876e-01, -9.3762e-01,
         5.1446e-01, -7.1605e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.0050e-02, -4.5387e-02,  0.0000e+00, -1.2264e+00,
        -1.4060e+00,  7.4562e-02, -1.6812e-02,  5.0167e+00,  0.0000e+00,
         0.0000e+00, -1.4247e+00, -2.3928e-01, -8.7121e-02,  1.6202e+00,
         2.5870e-03,  7.5664e-01, -3.9878e-01, -8.1722e-02, -1.6801e-02,
         1.0158e-01,  1.0000e+00,  0.0000e+00,  1.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1496]), tensor(0.0638))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986]
INFO:main.py:Testing data year: 1987
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 5109
            device: cpu
            
2024-07-10 01:47:51,987	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 01:47:52,020	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 01:47:52,048	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 01:47:52,053	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 01:47:54,012	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 01:49:29,216	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_01-47-53' in 0.0821s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 15, 'num_layers': 4, 'num_embeddings': 5109, 'embedding_dim': 30, 'dropout_rate': 0.12466311976626912, 'lr': 0.009, 'weight_decay': 5e-05, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.017621226209902006
INFO:model_data_nn.py:Best trial testing loss: 0.030591008686942273
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_01-47-49_405182_632180/artifacts/2024-07-10_01-47-53/train_fnn_2024-07-10_01-47-53/driver_artifacts/train_fnn_18dba_00002_2_dropout_rate=0.1247,embedding_dim=30,hidden_dim=15,lr=0.0090,num_layers=4,weight_decay=0.0001_2024-07-10_01-47-54
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 15, 'num_layers': 4, 'num_embeddings': 5697, 'embedding_dim': 30, 'dropout_rate': 0.12466311976626912, 'lr': 0.009, 'weight_decay': 5e-05, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 0.5754837931455536, 'avg_test_loss': 0.031689513844194946}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.02287727459333837, 'avg_test_loss': 0.022277476422934105}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.01976390161551535, 'avg_test_loss': 0.021973375787796533}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.02001956621184945, 'avg_test_loss': 0.022272036982821704}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.020073466046120633, 'avg_test_loss': 0.021745231491007398}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.019793830964375626, 'avg_test_loss': 0.022468338401623718}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.01958277322182601, 'avg_test_loss': 0.022248289441568373}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.019377153583548287, 'avg_test_loss': 0.021722107093133356}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.018767814930867065, 'avg_test_loss': 0.023134424249925043}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.018301125937564805, 'avg_test_loss': 0.029847356156729486}
INFO:model_data_nn.py:Epoch 11/40, metrics: {'avg_train_loss': 0.01802570402791554, 'avg_test_loss': 0.04422514591082607}
INFO:model_data_nn.py:Early stopping at epoch 11
INFO:main.py:Making prediction for data in year: 1988
INFO:main.py:Prediction data shape: (46885,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1988: 0.20993660287838425
INFO:main.py:Prediction Stats:                 ret          pred
count  46885.000000  46885.000000
mean       0.017541     -0.101645
std        0.147384      0.106701
min       -0.847619     -0.602344
25%       -0.052632     -0.175575
50%        0.000000     -0.069663
75%        0.070922     -0.010521
max        5.562500      0.092688
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987]
INFO:transform_data_nn.py:Train_data: (281499, 161)

INFO:transform_data_nn.py:Test data years: [1988]
INFO:transform_data_nn.py:Test_data: (46885, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988]
INFO:transform_data_nn.py:Retrain_data: (328384, 161)

INFO:transform_data_nn.py:Prediction data years: [1989]
INFO:transform_data_nn.py:Prediction_data: (47501, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([281499, 152])
            y_train_tf: torch.Size([281499])

            x_test_tf: torch.Size([46885, 152])
            y_test_tf: torch.Size([46885])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([328384, 152])
            y_retrain_tf: torch.Size([328384])

            x_prediction_tf: torch.Size([47501, 152])
            y_prediction_tf: torch.Size([47501])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.6485e-01,  1.8230e-01,  1.7097e-01, -1.2895e+00, -1.4861e-01,
        -6.3361e-01, -1.3953e-01, -3.2412e-01,  3.5052e-01, -1.6415e-01,
        -7.1298e-01, -8.7418e-02, -4.8984e-01, -2.8638e-02,  5.3805e-02,
         5.3585e-01, -1.5057e-01,  1.4105e-01,  0.0000e+00,  4.4826e-01,
        -3.6039e-01, -2.0729e-02,  2.5868e-02,  2.6469e-03, -6.5325e-02,
        -2.4458e-01, -5.7430e-01,  0.0000e+00,  3.6729e-01,  9.5292e-01,
         4.8242e-01, -1.2829e-01,  4.3593e-01,  0.0000e+00, -3.9010e-01,
        -1.9800e-01,  7.8118e-02,  4.8214e-01,  6.1557e-02, -1.1636e+00,
        -2.6444e-01,  1.3808e-01,  1.6335e-01, -6.4053e-02, -1.6169e-01,
        -6.7458e-01,  5.4317e-03, -7.7477e-02, -5.5695e-01, -2.3816e-01,
        -6.2338e-01,  6.4888e-01, -1.6650e-01, -1.9579e-03,  2.7732e-02,
         4.4700e-01, -7.7374e-01, -1.7885e-02, -2.7024e-01,  5.4831e-02,
         1.0554e-01, -3.3980e-01,  1.6083e-01,  2.9301e-01,  1.9625e-01,
        -1.0893e-01,  1.9625e-02, -6.5275e-02,  7.2753e-01, -4.1686e-01,
         0.0000e+00,  0.0000e+00, -1.7687e-02, -8.1674e-01,  1.3622e-02,
         6.0146e-01,  4.2794e-02, -3.4357e-01, -1.8006e-01, -1.1661e-02,
         0.0000e+00,  3.4367e-01,  5.3540e-02, -2.1577e-01, -5.6823e-01,
        -8.4531e-02, -6.9139e-02, -3.6387e-01, -1.5407e-01,  1.0011e-01,
        -5.2393e-01, -1.2947e+00,  1.1243e-01,  1.0997e+00,  1.5975e+00,
         1.5071e+00,  5.2009e-01,  1.1836e+00, -2.4439e+00, -5.6879e-01,
        -2.7414e-01,  1.5649e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.1913e-02, -4.5387e-02,  0.0000e+00, -1.7755e+00,
         4.2778e-02, -1.9666e+00,  1.2646e-01,  9.4528e-02,  0.0000e+00,
         0.0000e+00,  2.1740e-02, -1.7337e-01, -8.7121e-02,  3.3313e-02,
         1.9914e-01, -4.1977e-01, -3.9246e-01,  1.7793e-01,  2.3912e-01,
        -3.9531e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1644]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-1.1594e-02, -5.2073e-03, -6.3248e-01, -8.0822e-01, -7.0266e-01,
        -1.4151e-01, -1.8634e+00, -1.0292e+00, -8.8950e-03,  9.8507e-03,
        -3.5172e-01, -2.3780e-01,  5.1335e-02, -3.8287e-03,  3.3370e-02,
        -1.4351e+00, -2.2808e-01, -1.2205e-01,  0.0000e+00, -2.4636e-01,
         3.8865e-01, -2.0729e-02,  8.3911e-03,  3.7377e-02,  7.5325e-03,
        -6.3693e-01, -7.4307e-01,  0.0000e+00, -7.7996e-01,  3.6407e-02,
        -9.5491e-01, -3.4028e-01,  4.7802e-02,  0.0000e+00, -2.4158e+00,
         7.5641e-03, -6.2660e-01, -6.6273e-01, -2.9067e-01, -7.8528e-01,
         6.4925e-01, -9.4471e-01, -5.3122e-01, -1.8937e-01,  1.4665e-02,
        -1.4826e-01, -5.0533e-01, -3.3594e-01, -2.8811e-01, -7.2144e-03,
         1.2393e-01, -1.4796e+00, -4.8504e-01, -1.9579e-03, -7.4145e-01,
        -1.6221e+00, -1.0965e+00, -3.7581e-01, -5.2418e-02,  1.4472e-02,
        -2.8946e+00, -4.9031e-02, -8.8467e-02, -5.0532e+00, -9.7408e-03,
        -3.8957e-01, -1.0467e-02,  1.8309e+00, -5.8154e-01, -3.6450e-01,
         0.0000e+00,  0.0000e+00, -1.7687e-02,  8.9230e-02, -1.9116e-01,
        -2.3047e-01, -1.4984e-01,  3.2335e+00, -2.0202e-01, -1.1661e-02,
         0.0000e+00, -1.0029e+00, -2.6086e-02,  2.4173e+00,  3.8172e+00,
        -7.2883e-02, -6.3519e-02, -2.3079e-01,  6.0293e-01, -2.8818e-01,
         7.5226e-01,  5.6420e-01,  1.1243e-01, -7.3275e-01, -5.6379e-01,
        -1.0268e+00,  6.7123e-01, -1.0431e+00,  7.4876e-01, -9.3762e-01,
         5.1446e-01, -7.1605e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.0050e-02, -4.5387e-02,  0.0000e+00, -1.2264e+00,
        -1.4060e+00,  7.4562e-02, -1.6812e-02,  5.0167e+00,  0.0000e+00,
         0.0000e+00, -1.4247e+00, -2.3928e-01, -8.7121e-02,  1.6202e+00,
         2.5870e-03,  7.5664e-01, -3.9878e-01, -8.1722e-02, -1.6801e-02,
         1.0158e-01,  1.0000e+00,  0.0000e+00,  1.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1496]), tensor(0.0638))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.9844e-01,  1.5880e-01,  1.6742e-01, -1.2964e+00, -1.4980e-01,
        -6.3783e-01, -1.5070e-01, -3.3081e-01,  3.6132e-01, -1.5750e-01,
        -7.1271e-01, -3.7380e-02, -4.9664e-01,  9.8005e-03,  3.3467e-02,
         5.2172e-01, -1.3992e-01,  1.7420e-01,  0.0000e+00,  4.3468e-01,
        -3.6828e-01,  7.5725e-02,  2.5460e-02,  9.3107e-03, -6.7596e-02,
        -2.5247e-01, -5.6868e-01,  0.0000e+00,  3.8144e-01,  1.0111e+00,
         4.7515e-01, -1.2195e-01,  4.4010e-01,  0.0000e+00, -3.8085e-01,
        -1.9431e-01,  6.8593e-02,  5.1761e-01,  3.3254e-02, -1.1662e+00,
        -2.7735e-01,  2.7510e-01,  1.9260e-01, -6.6024e-02, -1.7060e-01,
        -6.7784e-01,  8.4519e-02, -8.4395e-02, -5.4257e-01, -1.9077e-01,
        -6.1714e-01,  6.5989e-01, -1.6348e-01,  1.0159e-03,  2.1732e-02,
         4.4457e-01, -7.6868e-01, -1.5251e-04, -2.6248e-01,  2.1522e-02,
         1.1277e-01, -3.2948e-01,  1.5361e-01,  2.8391e-01,  1.4703e-01,
        -1.1827e-01,  2.8385e-03, -7.3083e-02,  7.4370e-01, -4.1918e-01,
         0.0000e+00,  0.0000e+00, -2.3610e-01, -8.1725e-01,  3.7470e-02,
         5.8416e-01,  4.2455e-02, -3.4501e-01, -1.8188e-01, -2.3916e-03,
         0.0000e+00,  2.8639e-01,  6.1073e-02, -2.5530e-01, -5.5517e-01,
        -9.0869e-02, -7.4242e-02, -3.6215e-01, -1.4420e-01,  1.0281e-01,
        -5.1478e-01, -1.2853e+00,  4.8167e-02,  1.2549e+00,  1.7486e+00,
         1.6574e+00,  5.6220e-01,  1.3352e+00, -2.6341e+00, -4.1360e-01,
        -2.9873e-01,  1.2191e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  5.2007e-02,  2.3354e-01,  0.0000e+00, -1.4879e+00,
         2.6651e-01, -2.1535e+00,  1.3354e-01,  2.7724e-02,  0.0000e+00,
         0.0000e+00,  2.5039e-02, -1.7800e-01,  7.3311e-03,  7.8641e-03,
         1.7098e-01, -4.2237e-01, -3.8414e-01,  1.9750e-01,  2.4554e-01,
        -3.9752e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1786]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-1.1408e-02,  2.9146e-03, -6.1383e-01, -4.2858e-01, -2.9630e-01,
        -6.0289e-02, -1.9494e+00, -1.0588e+00, -3.6764e-02,  1.0514e-01,
        -2.3164e-02,  1.5815e-02, -4.1062e-02, -1.5777e-02,  4.1894e-02,
         3.7534e-01, -2.2006e-01, -4.8981e-01,  0.0000e+00,  2.6484e-03,
        -8.1112e-02,  7.5725e-02,  4.7021e-02,  9.6214e-01, -9.3196e-03,
        -5.7378e-03, -7.2997e-01,  0.0000e+00, -1.4391e+00,  4.6592e-02,
         4.3140e-01, -1.7324e-01,  2.7589e-01,  0.0000e+00,  4.8498e-04,
        -6.5325e-01,  7.3700e-03, -6.8489e-01, -8.4842e-01, -7.9342e-01,
         8.1526e-01,  9.7328e-02,  1.1858e-02,  2.3842e-02, -5.9593e-03,
         3.5118e-01,  8.3150e-02, -2.4606e-01, -4.1683e-01,  5.9663e-02,
         8.9991e-01, -1.3893e+00, -5.1699e-01, -2.5068e+00, -7.4364e-01,
         1.1063e-02, -1.0926e+00,  6.9774e-01,  6.0065e-03, -3.9788e-01,
        -6.2875e-03,  6.3306e-03,  1.2690e-02,  1.5952e-02, -2.4946e-02,
         4.0374e-03, -5.0861e-03,  1.7707e+00,  1.3950e+00, -1.1070e-02,
         0.0000e+00,  0.0000e+00, -2.3610e-01,  6.2752e-01,  1.6399e-02,
        -8.9769e-02,  3.0359e-04, -2.2936e-04,  6.4728e-04, -2.3916e-03,
         0.0000e+00, -3.2955e-01, -5.9469e-02, -4.4773e-01, -5.7442e-01,
        -7.8031e-02, -6.8496e-02,  2.5780e-02, -2.3675e-03, -9.3063e-02,
        -6.5661e-01,  6.1256e-01,  4.8167e-02, -6.9923e-01,  9.4130e-02,
        -1.0595e+00, -1.2968e+00, -1.1704e-01, -7.1630e-01, -1.0437e+00,
        -2.7773e-01, -9.0227e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.0181e-02,  2.3354e-01,  0.0000e+00, -1.2998e+00,
        -1.2019e+00,  4.1334e-01,  6.2665e-02,  2.7724e-02,  0.0000e+00,
         0.0000e+00,  1.3064e-02, -2.0316e-01,  7.3311e-03, -1.8639e-02,
        -1.0349e-02,  1.1680e-03, -2.4945e-02,  2.4751e-01,  1.9720e-01,
         1.3884e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1459]), tensor(0.0196))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987]
INFO:main.py:Testing data year: 1988
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 5697
            device: cpu
            
2024-07-10 02:30:16,770	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 02:30:16,807	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 02:30:16,838	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 02:30:16,843	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 02:30:18,873	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 02:31:46,267	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_02-30-18' in 0.0643s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 125, 'num_layers': 3, 'num_embeddings': 5697, 'embedding_dim': 25, 'dropout_rate': 0.13355100936547615, 'lr': 0.0009, 'weight_decay': 0.005, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.019359730882570148
INFO:model_data_nn.py:Best trial testing loss: 0.0218547353743697
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_02-30-14_237914_632180/artifacts/2024-07-10_02-30-18/train_fnn_2024-07-10_02-30-18/driver_artifacts/train_fnn_05bc5_00018_18_dropout_rate=0.1336,embedding_dim=25,hidden_dim=125,lr=0.0009,num_layers=3,weight_decay=0.0050_2024-07-10_02-30-18
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 125, 'num_layers': 3, 'num_embeddings': 6283, 'embedding_dim': 25, 'dropout_rate': 0.13355100936547615, 'lr': 0.0009, 'weight_decay': 0.005, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 5.111183384039954, 'avg_test_loss': 0.3106995481316761}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.2788562548062993, 'avg_test_loss': 0.05017543444910678}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.04662695976986099, 'avg_test_loss': 0.025209281428326524}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.021058516661089932, 'avg_test_loss': 0.030259457872479512}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.019851349140296015, 'avg_test_loss': 0.02392704767094905}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.019888787782973875, 'avg_test_loss': 0.024057138881455827}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.019633987723230526, 'avg_test_loss': 0.0239369883277123}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.01893887743687755, 'avg_test_loss': 0.023766519927409708}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.018638263855765363, 'avg_test_loss': 0.02375520521184049}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.018704109603796076, 'avg_test_loss': 0.02348348087010284}
INFO:model_data_nn.py:Epoch 11/40, metrics: {'avg_train_loss': 0.018745928371233674, 'avg_test_loss': 0.024493862288973985}
INFO:model_data_nn.py:Epoch 12/40, metrics: {'avg_train_loss': 0.018712324599153996, 'avg_test_loss': 0.023517981789986132}
INFO:model_data_nn.py:Epoch 13/40, metrics: {'avg_train_loss': 0.01868747626391362, 'avg_test_loss': 0.02366148381774384}
INFO:model_data_nn.py:Early stopping at epoch 13
INFO:main.py:Making prediction for data in year: 1989
INFO:main.py:Prediction data shape: (47501,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1989: 0.15365675542602697
INFO:main.py:Prediction Stats:                 ret          pred
count  47501.000000  47501.000000
mean       0.011252     -0.003610
std        0.153399      0.014756
min       -0.900000     -0.261550
25%       -0.055556     -0.014170
50%        0.000000      0.000686
75%        0.066140      0.005820
max        6.384615      0.083368
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988]
INFO:transform_data_nn.py:Train_data: (328384, 161)

INFO:transform_data_nn.py:Test data years: [1989]
INFO:transform_data_nn.py:Test_data: (47501, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989]
INFO:transform_data_nn.py:Retrain_data: (375885, 161)

INFO:transform_data_nn.py:Prediction data years: [1990]
INFO:transform_data_nn.py:Prediction_data: (46774, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([328384, 152])
            y_train_tf: torch.Size([328384])

            x_test_tf: torch.Size([47501, 152])
            y_test_tf: torch.Size([47501])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([375885, 152])
            y_retrain_tf: torch.Size([375885])

            x_prediction_tf: torch.Size([46774, 152])
            y_prediction_tf: torch.Size([46774])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.9844e-01,  1.5880e-01,  1.6742e-01, -1.2964e+00, -1.4980e-01,
        -6.3783e-01, -1.5070e-01, -3.3081e-01,  3.6132e-01, -1.5750e-01,
        -7.1271e-01, -3.7380e-02, -4.9664e-01,  9.8005e-03,  3.3467e-02,
         5.2172e-01, -1.3992e-01,  1.7420e-01,  0.0000e+00,  4.3468e-01,
        -3.6828e-01,  7.5725e-02,  2.5460e-02,  9.3107e-03, -6.7596e-02,
        -2.5247e-01, -5.6868e-01,  0.0000e+00,  3.8144e-01,  1.0111e+00,
         4.7515e-01, -1.2195e-01,  4.4010e-01,  0.0000e+00, -3.8085e-01,
        -1.9431e-01,  6.8593e-02,  5.1761e-01,  3.3254e-02, -1.1662e+00,
        -2.7735e-01,  2.7510e-01,  1.9260e-01, -6.6024e-02, -1.7060e-01,
        -6.7784e-01,  8.4519e-02, -8.4395e-02, -5.4257e-01, -1.9077e-01,
        -6.1714e-01,  6.5989e-01, -1.6348e-01,  1.0159e-03,  2.1732e-02,
         4.4457e-01, -7.6868e-01, -1.5251e-04, -2.6248e-01,  2.1522e-02,
         1.1277e-01, -3.2948e-01,  1.5361e-01,  2.8391e-01,  1.4703e-01,
        -1.1827e-01,  2.8385e-03, -7.3083e-02,  7.4370e-01, -4.1918e-01,
         0.0000e+00,  0.0000e+00, -2.3610e-01, -8.1725e-01,  3.7470e-02,
         5.8416e-01,  4.2455e-02, -3.4501e-01, -1.8188e-01, -2.3916e-03,
         0.0000e+00,  2.8639e-01,  6.1073e-02, -2.5530e-01, -5.5517e-01,
        -9.0869e-02, -7.4242e-02, -3.6215e-01, -1.4420e-01,  1.0281e-01,
        -5.1478e-01, -1.2853e+00,  4.8167e-02,  1.2549e+00,  1.7486e+00,
         1.6574e+00,  5.6220e-01,  1.3352e+00, -2.6341e+00, -4.1360e-01,
        -2.9873e-01,  1.2191e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  5.2007e-02,  2.3354e-01,  0.0000e+00, -1.4879e+00,
         2.6651e-01, -2.1535e+00,  1.3354e-01,  2.7724e-02,  0.0000e+00,
         0.0000e+00,  2.5039e-02, -1.7800e-01,  7.3311e-03,  7.8641e-03,
         1.7098e-01, -4.2237e-01, -3.8414e-01,  1.9750e-01,  2.4554e-01,
        -3.9752e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1786]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-1.1408e-02,  2.9146e-03, -6.1383e-01, -4.2858e-01, -2.9630e-01,
        -6.0289e-02, -1.9494e+00, -1.0588e+00, -3.6764e-02,  1.0514e-01,
        -2.3164e-02,  1.5815e-02, -4.1062e-02, -1.5777e-02,  4.1894e-02,
         3.7534e-01, -2.2006e-01, -4.8981e-01,  0.0000e+00,  2.6484e-03,
        -8.1112e-02,  7.5725e-02,  4.7021e-02,  9.6214e-01, -9.3196e-03,
        -5.7378e-03, -7.2997e-01,  0.0000e+00, -1.4391e+00,  4.6592e-02,
         4.3140e-01, -1.7324e-01,  2.7589e-01,  0.0000e+00,  4.8498e-04,
        -6.5325e-01,  7.3700e-03, -6.8489e-01, -8.4842e-01, -7.9342e-01,
         8.1526e-01,  9.7328e-02,  1.1858e-02,  2.3842e-02, -5.9593e-03,
         3.5118e-01,  8.3150e-02, -2.4606e-01, -4.1683e-01,  5.9663e-02,
         8.9991e-01, -1.3893e+00, -5.1699e-01, -2.5068e+00, -7.4364e-01,
         1.1063e-02, -1.0926e+00,  6.9774e-01,  6.0065e-03, -3.9788e-01,
        -6.2875e-03,  6.3306e-03,  1.2690e-02,  1.5952e-02, -2.4946e-02,
         4.0374e-03, -5.0861e-03,  1.7707e+00,  1.3950e+00, -1.1070e-02,
         0.0000e+00,  0.0000e+00, -2.3610e-01,  6.2752e-01,  1.6399e-02,
        -8.9769e-02,  3.0359e-04, -2.2936e-04,  6.4728e-04, -2.3916e-03,
         0.0000e+00, -3.2955e-01, -5.9469e-02, -4.4773e-01, -5.7442e-01,
        -7.8031e-02, -6.8496e-02,  2.5780e-02, -2.3675e-03, -9.3063e-02,
        -6.5661e-01,  6.1256e-01,  4.8167e-02, -6.9923e-01,  9.4130e-02,
        -1.0595e+00, -1.2968e+00, -1.1704e-01, -7.1630e-01, -1.0437e+00,
        -2.7773e-01, -9.0227e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.0181e-02,  2.3354e-01,  0.0000e+00, -1.2998e+00,
        -1.2019e+00,  4.1334e-01,  6.2665e-02,  2.7724e-02,  0.0000e+00,
         0.0000e+00,  1.3064e-02, -2.0316e-01,  7.3311e-03, -1.8639e-02,
        -1.0349e-02,  1.1680e-03, -2.4945e-02,  2.4751e-01,  1.9720e-01,
         1.3884e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1459]), tensor(0.0196))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.8972e-01,  2.6420e-01,  1.5363e-01, -1.3069e+00, -1.4162e-01,
        -6.3605e-01, -1.6024e-01, -3.3749e-01,  3.7729e-01, -1.5824e-01,
        -7.1147e-01, -2.1879e-02, -5.0366e-01, -4.2017e-02,  5.9299e-02,
         5.1382e-01, -1.3424e-01,  1.9280e-01, -1.6829e-02,  4.2506e-01,
        -3.7289e-01,  9.2791e-02,  3.2835e-02,  1.1438e-02, -6.5504e-02,
        -2.5784e-01, -5.7382e-01, -6.8662e-02,  3.8562e-01,  1.0585e+00,
         4.7048e-01, -1.0666e-01,  4.4478e-01,  9.8409e-02, -3.7696e-01,
        -1.9346e-01,  7.3482e-02,  5.4720e-01,  1.7244e-02, -1.1608e+00,
        -2.8468e-01,  2.8830e-01,  2.1189e-01, -6.6772e-02, -1.7456e-01,
        -6.7313e-01,  8.4234e-02, -8.6078e-02, -4.8579e-01, -1.9296e-01,
        -6.3076e-01,  6.6311e-01, -1.5736e-01, -9.1068e-02,  2.1848e-02,
         4.3744e-01, -7.6442e-01,  1.3773e-02, -2.5472e-01, -4.8971e-03,
         1.1931e-01, -3.1866e-01,  1.4727e-01,  2.7139e-01,  1.2354e-01,
        -1.2522e-01,  8.2618e-02, -8.0370e-02,  7.3884e-01, -4.1938e-01,
         0.0000e+00,  0.0000e+00, -1.4421e-01, -8.1085e-01,  5.6494e-02,
         5.8140e-01,  3.9013e-02, -3.4606e-01, -1.8280e-01,  7.9242e-04,
        -2.2414e-02,  2.5705e-01,  6.6266e-02, -2.8663e-01, -5.5589e-01,
        -9.6492e-02, -7.8649e-02, -3.5369e-01, -1.2660e-01,  1.1666e-01,
        -5.1295e-01, -1.2772e+00,  1.3821e-02,  1.3845e+00,  1.8870e+00,
         1.7755e+00,  7.0894e-01,  1.4378e+00, -2.4874e+00, -2.2063e-01,
        -2.9489e-01,  1.0297e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  5.4179e-02,  2.6416e-01,  0.0000e+00, -1.2481e+00,
         4.0861e-01, -2.3284e+00,  1.3995e-01,  3.2667e-02,  0.0000e+00,
         0.0000e+00,  1.9527e-02, -1.8033e-01,  6.7643e-03, -1.7292e-02,
         6.7000e-02, -4.3188e-01, -3.7835e-01,  2.1099e-01,  2.4922e-01,
        -3.9976e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1873]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([ 1.8820e-02,  8.3680e-02, -7.9874e-01, -1.1744e-01,  8.1926e-01,
        -7.0996e-01, -1.9966e+00, -1.0775e+00, -3.6405e-01, -1.3855e-01,
        -1.6774e-02,  9.3288e-03, -4.2412e-02, -6.4712e-02,  3.6116e-02,
         5.4810e-01, -1.9479e-01,  7.7155e-01,  4.5852e-01,  8.7119e-03,
         7.4209e-01, -1.8899e-01,  5.2501e-02, -4.2265e-01,  5.2064e-01,
        -6.4386e-03, -7.2439e-01, -6.8662e-02, -8.0948e-01,  4.1203e-02,
         1.8714e-01,  1.3541e-02,  3.3481e-01,  9.8409e-02, -1.4494e-03,
        -1.1368e+00,  1.3192e-02, -7.0466e-01,  6.3335e-01, -7.0855e-01,
        -1.4501e-01,  1.5804e-01,  1.2192e-02,  2.3968e-02, -3.7000e-03,
        -4.4552e-01,  9.5932e-01,  2.0401e-01, -4.1580e-01,  1.2171e+00,
         1.6730e+00, -1.1007e+00, -6.2636e-01, -1.2679e+00, -7.4223e-01,
         8.0022e-03, -1.0893e+00,  1.1615e+00, -7.9993e-04,  6.2808e-02,
        -3.9909e-03, -2.7642e-04,  9.0410e-03,  1.8528e-02, -1.0378e-02,
         3.0594e-05,  5.1983e-02, -2.5582e+00,  8.5946e-02, -1.0104e-02,
         0.0000e+00,  0.0000e+00, -1.4421e-01, -5.5099e-01,  1.1204e-02,
         3.0825e-01,  9.9530e-04, -1.9123e-03,  2.5390e-03,  7.9242e-04,
         1.9376e-01,  6.0692e-01, -1.5442e-01,  2.0061e-02, -4.6656e-01,
        -8.4911e-02, -7.3589e-02,  3.1820e-02,  5.3414e-03,  2.8129e-01,
        -5.4592e-01, -1.2772e+00,  1.3821e-02, -1.1170e+00, -8.8277e-01,
        -1.2188e+00, -5.4814e-01, -2.8496e-01, -9.4263e-01, -1.1195e+00,
        -2.3083e-01,  1.6644e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.6646e-02,  3.1921e-01,  0.0000e+00, -9.3808e-01,
        -9.4247e-01,  2.4640e-01,  1.1855e-01,  3.2667e-02,  0.0000e+00,
         0.0000e+00,  1.1356e-02,  2.3742e-01,  6.7643e-03, -1.8907e-02,
        -5.7504e-02,  4.7245e-04, -2.3224e-02,  3.4302e-01,  3.7060e-01,
        -2.7359e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1415]), tensor(-0.0185))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988]
INFO:main.py:Testing data year: 1989
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 6283
            device: cpu
            
2024-07-10 03:18:32,339	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 03:18:32,375	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 03:18:32,404	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 03:18:32,409	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 03:18:34,369	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 03:22:54,154	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_03-18-34' in 0.0816s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 45, 'num_layers': 2, 'num_embeddings': 6283, 'embedding_dim': 10, 'dropout_rate': 0.07256929214357004, 'lr': 0.0009, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.019741278362408896
INFO:model_data_nn.py:Best trial testing loss: 0.023783555321936167
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_03-18-29_794140_632180/artifacts/2024-07-10_03-18-34/train_fnn_2024-07-10_03-18-34/driver_artifacts/train_fnn_c3960_00013_13_dropout_rate=0.0726,embedding_dim=10,hidden_dim=45,lr=0.0009,num_layers=2,weight_decay=0.0001_2024-07-10_03-18-34
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 45, 'num_layers': 2, 'num_embeddings': 6562, 'embedding_dim': 10, 'dropout_rate': 0.07256929214357004, 'lr': 0.0009, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 8.812305906826822, 'avg_test_loss': 1.0493186132503989}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.9605485607037502, 'avg_test_loss': 0.2642445356630888}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.22427740211264466, 'avg_test_loss': 0.08097838877084476}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.051184375254961, 'avg_test_loss': 0.03850159903509858}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.022105061031949, 'avg_test_loss': 0.03313414712787652}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.0202510364384088, 'avg_test_loss': 0.03280464841734842}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.020371938219396656, 'avg_test_loss': 0.032505636093272866}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.02045688717362932, 'avg_test_loss': 0.03272993424449299}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.020345604350857582, 'avg_test_loss': 0.03196376701562457}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.020110847883007613, 'avg_test_loss': 0.031753673650772196}
INFO:model_data_nn.py:Epoch 11/40, metrics: {'avg_train_loss': 0.01969931185831315, 'avg_test_loss': 0.0333839116638394}
INFO:model_data_nn.py:Epoch 12/40, metrics: {'avg_train_loss': 0.01921193660639475, 'avg_test_loss': 0.03304168390608876}
INFO:model_data_nn.py:Epoch 13/40, metrics: {'avg_train_loss': 0.01881752489546759, 'avg_test_loss': 0.0362153067278976}
INFO:model_data_nn.py:Early stopping at epoch 13
INFO:main.py:Making prediction for data in year: 1990
INFO:main.py:Prediction data shape: (46774,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1990: 0.19025112302405878
INFO:main.py:Prediction Stats:                 ret          pred
count  46774.000000  46774.000000
mean      -0.017088      0.047618
std        0.177055      0.038919
min       -0.916667     -0.143426
25%       -0.103448      0.020593
50%       -0.017544      0.036920
75%        0.054461      0.070988
max        3.400000      0.221082
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989]
INFO:transform_data_nn.py:Train_data: (375885, 161)

INFO:transform_data_nn.py:Test data years: [1990]
INFO:transform_data_nn.py:Test_data: (46774, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990]
INFO:transform_data_nn.py:Retrain_data: (422659, 161)

INFO:transform_data_nn.py:Prediction data years: [1991]
INFO:transform_data_nn.py:Prediction_data: (47150, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([375885, 152])
            y_train_tf: torch.Size([375885])

            x_test_tf: torch.Size([46774, 152])
            y_test_tf: torch.Size([46774])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([422659, 152])
            y_retrain_tf: torch.Size([422659])

            x_prediction_tf: torch.Size([47150, 152])
            y_prediction_tf: torch.Size([47150])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.8972e-01,  2.6420e-01,  1.5363e-01, -1.3069e+00, -1.4162e-01,
        -6.3605e-01, -1.6024e-01, -3.3749e-01,  3.7729e-01, -1.5824e-01,
        -7.1147e-01, -2.1879e-02, -5.0366e-01, -4.2017e-02,  5.9299e-02,
         5.1382e-01, -1.3424e-01,  1.9280e-01, -1.6829e-02,  4.2506e-01,
        -3.7289e-01,  9.2791e-02,  3.2835e-02,  1.1438e-02, -6.5504e-02,
        -2.5784e-01, -5.7382e-01, -6.8662e-02,  3.8562e-01,  1.0585e+00,
         4.7048e-01, -1.0666e-01,  4.4478e-01,  9.8409e-02, -3.7696e-01,
        -1.9346e-01,  7.3482e-02,  5.4720e-01,  1.7244e-02, -1.1608e+00,
        -2.8468e-01,  2.8830e-01,  2.1189e-01, -6.6772e-02, -1.7456e-01,
        -6.7313e-01,  8.4234e-02, -8.6078e-02, -4.8579e-01, -1.9296e-01,
        -6.3076e-01,  6.6311e-01, -1.5736e-01, -9.1068e-02,  2.1848e-02,
         4.3744e-01, -7.6442e-01,  1.3773e-02, -2.5472e-01, -4.8971e-03,
         1.1931e-01, -3.1866e-01,  1.4727e-01,  2.7139e-01,  1.2354e-01,
        -1.2522e-01,  8.2618e-02, -8.0370e-02,  7.3884e-01, -4.1938e-01,
         0.0000e+00,  0.0000e+00, -1.4421e-01, -8.1085e-01,  5.6494e-02,
         5.8140e-01,  3.9013e-02, -3.4606e-01, -1.8280e-01,  7.9242e-04,
        -2.2414e-02,  2.5705e-01,  6.6266e-02, -2.8663e-01, -5.5589e-01,
        -9.6492e-02, -7.8649e-02, -3.5369e-01, -1.2660e-01,  1.1666e-01,
        -5.1295e-01, -1.2772e+00,  1.3821e-02,  1.3845e+00,  1.8870e+00,
         1.7755e+00,  7.0894e-01,  1.4378e+00, -2.4874e+00, -2.2063e-01,
        -2.9489e-01,  1.0297e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  5.4179e-02,  2.6416e-01,  0.0000e+00, -1.2481e+00,
         4.0861e-01, -2.3284e+00,  1.3995e-01,  3.2667e-02,  0.0000e+00,
         0.0000e+00,  1.9527e-02, -1.8033e-01,  6.7643e-03, -1.7292e-02,
         6.7000e-02, -4.3188e-01, -3.7835e-01,  2.1099e-01,  2.4922e-01,
        -3.9976e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1873]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 1.8820e-02,  8.3680e-02, -7.9874e-01, -1.1744e-01,  8.1926e-01,
        -7.0996e-01, -1.9966e+00, -1.0775e+00, -3.6405e-01, -1.3855e-01,
        -1.6774e-02,  9.3288e-03, -4.2412e-02, -6.4712e-02,  3.6116e-02,
         5.4810e-01, -1.9479e-01,  7.7155e-01,  4.5852e-01,  8.7119e-03,
         7.4209e-01, -1.8899e-01,  5.2501e-02, -4.2265e-01,  5.2064e-01,
        -6.4386e-03, -7.2439e-01, -6.8662e-02, -8.0948e-01,  4.1203e-02,
         1.8714e-01,  1.3541e-02,  3.3481e-01,  9.8409e-02, -1.4494e-03,
        -1.1368e+00,  1.3192e-02, -7.0466e-01,  6.3335e-01, -7.0855e-01,
        -1.4501e-01,  1.5804e-01,  1.2192e-02,  2.3968e-02, -3.7000e-03,
        -4.4552e-01,  9.5932e-01,  2.0401e-01, -4.1580e-01,  1.2171e+00,
         1.6730e+00, -1.1007e+00, -6.2636e-01, -1.2679e+00, -7.4223e-01,
         8.0022e-03, -1.0893e+00,  1.1615e+00, -7.9993e-04,  6.2808e-02,
        -3.9909e-03, -2.7642e-04,  9.0410e-03,  1.8528e-02, -1.0378e-02,
         3.0594e-05,  5.1983e-02, -2.5582e+00,  8.5946e-02, -1.0104e-02,
         0.0000e+00,  0.0000e+00, -1.4421e-01, -5.5099e-01,  1.1204e-02,
         3.0825e-01,  9.9530e-04, -1.9123e-03,  2.5390e-03,  7.9242e-04,
         1.9376e-01,  6.0692e-01, -1.5442e-01,  2.0061e-02, -4.6656e-01,
        -8.4911e-02, -7.3589e-02,  3.1820e-02,  5.3414e-03,  2.8129e-01,
        -5.4592e-01, -1.2772e+00,  1.3821e-02, -1.1170e+00, -8.8277e-01,
        -1.2188e+00, -5.4814e-01, -2.8496e-01, -9.4263e-01, -1.1195e+00,
        -2.3083e-01,  1.6644e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.6646e-02,  3.1921e-01,  0.0000e+00, -9.3808e-01,
        -9.4247e-01,  2.4640e-01,  1.1855e-01,  3.2667e-02,  0.0000e+00,
         0.0000e+00,  1.1356e-02,  2.3742e-01,  6.7643e-03, -1.8907e-02,
        -5.7504e-02,  4.7245e-04, -2.3224e-02,  3.4302e-01,  3.7060e-01,
        -2.7359e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1415]), tensor(-0.0185))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.7425e-01,  3.7754e-01,  1.4934e-01, -1.3170e+00, -1.3253e-01,
        -6.4465e-01, -1.6967e-01, -3.4584e-01,  3.4598e-01, -1.5492e-01,
        -7.0767e-01, -1.1320e-02, -4.9315e-01, -1.1341e-01,  7.7373e-02,
         5.1234e-01, -1.2838e-01,  1.9862e-01, -4.8695e-02,  4.3362e-01,
        -3.5150e-01,  3.8941e-02,  3.6587e-02,  1.5554e-02, -5.9349e-02,
        -2.6173e-01, -5.6831e-01, -2.7338e-04,  3.9550e-01,  1.0619e+00,
         4.6676e-01, -9.5131e-02,  4.4205e-01,  8.6933e-03, -3.7636e-01,
        -1.9066e-01,  7.8067e-02,  5.6022e-01,  1.4630e-02, -1.1506e+00,
        -2.9475e-01,  3.6848e-01,  2.3401e-01, -8.0414e-02, -1.7311e-01,
        -6.7188e-01,  1.2521e-01, -5.8672e-02, -4.5347e-01, -1.4579e-01,
        -6.4478e-01,  6.6964e-01, -1.5089e-01, -6.6906e-02,  2.4691e-02,
         4.3137e-01, -7.5919e-01,  3.8151e-02, -2.5174e-01, -1.8652e-02,
         1.2382e-01, -3.1448e-01,  1.4006e-01,  2.6348e-01,  1.1506e-01,
        -1.3377e-01,  1.6539e-01, -8.0429e-02,  7.3199e-01, -4.2069e-01,
         0.0000e+00,  0.0000e+00, -9.4989e-02, -8.0793e-01,  6.9545e-02,
         5.7868e-01,  3.3156e-02, -3.4722e-01, -1.8260e-01,  3.4026e-03,
        -6.5914e-03,  2.4846e-01,  4.3762e-02, -3.1158e-01, -5.5520e-01,
        -1.0190e-01, -8.3315e-02, -3.4428e-01, -1.0836e-01,  1.3599e-01,
        -5.0767e-01, -1.2661e+00,  3.9227e-03,  1.4985e+00,  2.0153e+00,
         1.9005e+00,  7.5873e-01,  1.5519e+00, -2.5355e+00, -1.0712e-01,
        -3.0477e-01,  1.0635e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.0060e-02,  2.7572e-01,  0.0000e+00, -1.1510e+00,
         5.3159e-01, -2.2985e+00,  1.4497e-01,  3.1339e-02,  0.0000e+00,
         0.0000e+00,  1.4065e-02, -1.8017e-01,  9.3949e-03, -3.9383e-02,
         3.7427e-02, -4.3923e-01, -3.6782e-01,  2.2340e-01,  2.5535e-01,
        -4.0639e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1947]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([ 1.2993e-02,  7.0280e-02,  5.4580e-01,  1.4098e-01, -3.7937e-01,
        -3.2199e-01, -2.0970e+00, -1.0822e+00, -2.2737e-01, -3.1425e-01,
        -1.5613e-02,  5.8420e-03, -2.8197e-02, -5.8125e-02,  3.6224e-02,
        -1.3633e+00, -1.4110e-01,  5.8407e-02,  1.1676e-01,  1.4697e-02,
         6.4857e-02, -1.1747e-01,  5.8770e-01, -2.9751e-01, -3.5050e-01,
        -6.5498e-03, -6.6369e-01, -2.7338e-04, -1.0685e+00,  2.7080e-02,
        -2.0452e-01, -4.7176e-02,  2.9836e-01,  8.6933e-03, -5.4638e-04,
        -5.2011e-01,  7.9955e-03, -7.1260e-01, -1.1614e-01, -9.4484e-01,
         6.9123e-02, -7.7512e-01,  1.3185e-02,  1.1272e-02,  7.3407e-04,
         6.7760e-02, -2.7334e-01, -4.8967e-02,  7.1605e-01, -1.4864e-01,
         9.0603e-01, -1.0786e+00, -5.5943e-01, -9.6500e-01, -7.4081e-01,
         7.2555e-03, -1.0852e+00, -3.4742e-01, -2.2293e-03,  1.3772e-01,
        -5.0189e-03, -3.0738e-03,  9.1674e-03,  1.3885e-02, -7.3406e-03,
         7.6830e-04,  4.4575e-02, -4.2739e-01,  7.5308e-02, -9.8693e-03,
         0.0000e+00,  0.0000e+00, -9.4989e-02,  1.4364e-02,  9.7428e-03,
        -3.9122e-01,  1.5581e-03, -2.7052e-03,  7.7936e-04,  3.4026e-03,
         1.6028e-01, -5.3828e-01, -1.7883e-01,  6.0396e-01, -4.9598e-01,
        -9.2094e-02, -7.8620e-02,  2.6062e-02,  4.3028e-03,  1.0161e-01,
        -6.5284e-01,  9.4613e-01,  3.9227e-03, -2.9295e-01, -8.0607e-01,
        -7.0806e-01,  4.3613e-02, -6.3081e-01, -1.5640e-01,  4.2306e-02,
        -2.5627e-01,  9.5470e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.8296e-02,  2.1888e-01,  0.0000e+00, -1.0606e+00,
        -1.5565e+00, -1.9042e+00,  1.1952e-01,  3.1339e-02,  0.0000e+00,
         0.0000e+00,  1.1698e-02, -2.3071e-01,  9.3949e-03, -1.7782e-02,
         8.5195e-03,  7.6178e-05, -1.4510e-02,  2.6743e-01,  2.6624e-01,
        -2.8328e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1437]), tensor(0.0132))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989]
INFO:main.py:Testing data year: 1990
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 6562
            device: cpu
            
2024-07-10 04:15:17,899	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 04:15:17,937	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 04:15:17,969	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 04:15:17,974	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 04:15:19,646	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 04:18:06,675	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_04-15-19' in 0.0833s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 125, 'num_layers': 3, 'num_embeddings': 6562, 'embedding_dim': 25, 'dropout_rate': 0.13355100936547615, 'lr': 0.0009, 'weight_decay': 0.005, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.019448134061037844
INFO:model_data_nn.py:Best trial testing loss: 0.03241123555767569
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_04-15-15_446078_632180/artifacts/2024-07-10_04-15-19/train_fnn_2024-07-10_04-15-19/driver_artifacts/train_fnn_b14a1_00018_18_dropout_rate=0.1336,embedding_dim=25,hidden_dim=125,lr=0.0009,num_layers=3,weight_decay=0.0050_2024-07-10_04-15-19
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 125, 'num_layers': 3, 'num_embeddings': 6817, 'embedding_dim': 25, 'dropout_rate': 0.13355100936547615, 'lr': 0.0009, 'weight_decay': 0.005, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 1.4673799098487357, 'avg_test_loss': 0.048149829508887756}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.023389388788795915, 'avg_test_loss': 0.04735233705188777}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.02172722836469298, 'avg_test_loss': 0.04716346997364953}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.021599750470293385, 'avg_test_loss': 0.047701144193273946}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.02103955218975475, 'avg_test_loss': 0.04783634330473236}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.02069725597798193, 'avg_test_loss': 0.052876670472323896}
INFO:model_data_nn.py:Early stopping at epoch 6
INFO:main.py:Making prediction for data in year: 1991
INFO:main.py:Prediction data shape: (47150,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1991: 0.2299559729224131
INFO:main.py:Prediction Stats:                 ret          pred
count  47150.000000  47150.000000
mean       0.038270     -0.032711
std        0.216332      0.052306
min       -0.937500     -0.374549
25%       -0.058140     -0.067627
50%        0.011494     -0.025041
75%        0.100000      0.006408
max        9.000000      0.111781
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990]
INFO:transform_data_nn.py:Train_data: (422659, 161)

INFO:transform_data_nn.py:Test data years: [1991]
INFO:transform_data_nn.py:Test_data: (47150, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991]
INFO:transform_data_nn.py:Retrain_data: (469809, 161)

INFO:transform_data_nn.py:Prediction data years: [1992]
INFO:transform_data_nn.py:Prediction_data: (47572, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([422659, 152])
            y_train_tf: torch.Size([422659])

            x_test_tf: torch.Size([47150, 152])
            y_test_tf: torch.Size([47150])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([469809, 152])
            y_retrain_tf: torch.Size([469809])

            x_prediction_tf: torch.Size([47572, 152])
            y_prediction_tf: torch.Size([47572])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.7425e-01,  3.7754e-01,  1.4934e-01, -1.3170e+00, -1.3253e-01,
        -6.4465e-01, -1.6967e-01, -3.4584e-01,  3.4598e-01, -1.5492e-01,
        -7.0767e-01, -1.1320e-02, -4.9315e-01, -1.1341e-01,  7.7373e-02,
         5.1234e-01, -1.2838e-01,  1.9862e-01, -4.8695e-02,  4.3362e-01,
        -3.5150e-01,  3.8941e-02,  3.6587e-02,  1.5554e-02, -5.9349e-02,
        -2.6173e-01, -5.6831e-01, -2.7338e-04,  3.9550e-01,  1.0619e+00,
         4.6676e-01, -9.5131e-02,  4.4205e-01,  8.6933e-03, -3.7636e-01,
        -1.9066e-01,  7.8067e-02,  5.6022e-01,  1.4630e-02, -1.1506e+00,
        -2.9475e-01,  3.6848e-01,  2.3401e-01, -8.0414e-02, -1.7311e-01,
        -6.7188e-01,  1.2521e-01, -5.8672e-02, -4.5347e-01, -1.4579e-01,
        -6.4478e-01,  6.6964e-01, -1.5089e-01, -6.6906e-02,  2.4691e-02,
         4.3137e-01, -7.5919e-01,  3.8151e-02, -2.5174e-01, -1.8652e-02,
         1.2382e-01, -3.1448e-01,  1.4006e-01,  2.6348e-01,  1.1506e-01,
        -1.3377e-01,  1.6539e-01, -8.0429e-02,  7.3199e-01, -4.2069e-01,
         0.0000e+00,  0.0000e+00, -9.4989e-02, -8.0793e-01,  6.9545e-02,
         5.7868e-01,  3.3156e-02, -3.4722e-01, -1.8260e-01,  3.4026e-03,
        -6.5914e-03,  2.4846e-01,  4.3762e-02, -3.1158e-01, -5.5520e-01,
        -1.0190e-01, -8.3315e-02, -3.4428e-01, -1.0836e-01,  1.3599e-01,
        -5.0767e-01, -1.2661e+00,  3.9227e-03,  1.4985e+00,  2.0153e+00,
         1.9005e+00,  7.5873e-01,  1.5519e+00, -2.5355e+00, -1.0712e-01,
        -3.0477e-01,  1.0635e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.0060e-02,  2.7572e-01,  0.0000e+00, -1.1510e+00,
         5.3159e-01, -2.2985e+00,  1.4497e-01,  3.1339e-02,  0.0000e+00,
         0.0000e+00,  1.4065e-02, -1.8017e-01,  9.3949e-03, -3.9383e-02,
         3.7427e-02, -4.3923e-01, -3.6782e-01,  2.2340e-01,  2.5535e-01,
        -4.0639e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1947]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 1.2993e-02,  7.0280e-02,  5.4580e-01,  1.4098e-01, -3.7937e-01,
        -3.2199e-01, -2.0970e+00, -1.0822e+00, -2.2737e-01, -3.1425e-01,
        -1.5613e-02,  5.8420e-03, -2.8197e-02, -5.8125e-02,  3.6224e-02,
        -1.3633e+00, -1.4110e-01,  5.8407e-02,  1.1676e-01,  1.4697e-02,
         6.4857e-02, -1.1747e-01,  5.8770e-01, -2.9751e-01, -3.5050e-01,
        -6.5498e-03, -6.6369e-01, -2.7338e-04, -1.0685e+00,  2.7080e-02,
        -2.0452e-01, -4.7176e-02,  2.9836e-01,  8.6933e-03, -5.4638e-04,
        -5.2011e-01,  7.9955e-03, -7.1260e-01, -1.1614e-01, -9.4484e-01,
         6.9123e-02, -7.7512e-01,  1.3185e-02,  1.1272e-02,  7.3407e-04,
         6.7760e-02, -2.7334e-01, -4.8967e-02,  7.1605e-01, -1.4864e-01,
         9.0603e-01, -1.0786e+00, -5.5943e-01, -9.6500e-01, -7.4081e-01,
         7.2555e-03, -1.0852e+00, -3.4742e-01, -2.2293e-03,  1.3772e-01,
        -5.0189e-03, -3.0738e-03,  9.1674e-03,  1.3885e-02, -7.3406e-03,
         7.6830e-04,  4.4575e-02, -4.2739e-01,  7.5308e-02, -9.8693e-03,
         0.0000e+00,  0.0000e+00, -9.4989e-02,  1.4364e-02,  9.7428e-03,
        -3.9122e-01,  1.5581e-03, -2.7052e-03,  7.7936e-04,  3.4026e-03,
         1.6028e-01, -5.3828e-01, -1.7883e-01,  6.0396e-01, -4.9598e-01,
        -9.2094e-02, -7.8620e-02,  2.6062e-02,  4.3028e-03,  1.0161e-01,
        -6.5284e-01,  9.4613e-01,  3.9227e-03, -2.9295e-01, -8.0607e-01,
        -7.0806e-01,  4.3613e-02, -6.3081e-01, -1.5640e-01,  4.2306e-02,
        -2.5627e-01,  9.5470e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  2.8296e-02,  2.1888e-01,  0.0000e+00, -1.0606e+00,
        -1.5565e+00, -1.9042e+00,  1.1952e-01,  3.1339e-02,  0.0000e+00,
         0.0000e+00,  1.1698e-02, -2.3071e-01,  9.3949e-03, -1.7782e-02,
         8.5195e-03,  7.6178e-05, -1.4510e-02,  2.6743e-01,  2.6624e-01,
        -2.8328e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1437]), tensor(0.0132))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.7234e-01,  4.6972e-01,  1.3369e-01, -1.3233e+00, -1.1615e-01,
        -6.5763e-01, -1.7787e-01, -3.5546e-01,  3.2117e-01, -1.5645e-01,
        -7.0541e-01, -1.5574e-03, -4.8483e-01, -1.7368e-01,  8.8285e-02,
         5.0900e-01, -1.2565e-01,  1.9820e-01, -8.7710e-02,  4.5217e-01,
        -3.6214e-01,  1.5567e-03,  1.2075e-02,  2.0896e-02, -5.7166e-02,
        -2.6419e-01, -5.6232e-01, -1.1018e-02,  3.9683e-01,  1.0666e+00,
         4.3934e-01, -8.5856e-02,  4.4396e-01, -5.2619e-03, -3.7864e-01,
        -1.8745e-01,  8.5812e-02,  5.7862e-01,  2.0035e-02, -1.1342e+00,
        -3.0314e-01,  3.5782e-01,  2.6210e-01, -9.0749e-02, -1.6322e-01,
        -6.7575e-01,  1.2232e-01, -7.2473e-02, -4.3025e-01, -1.6126e-01,
        -6.6996e-01,  6.6997e-01, -1.4319e-01, -4.9841e-02,  3.0161e-02,
         4.2920e-01, -7.5336e-01,  5.1860e-02, -2.4874e-01, -2.6112e-02,
         1.2572e-01, -3.1123e-01,  1.3579e-01,  2.5557e-01,  1.1514e-01,
        -1.4038e-01,  2.3383e-01, -9.0486e-02,  7.2582e-01, -4.2017e-01,
        -1.2030e-01, -4.4965e-02, -7.9972e-02, -8.0907e-01,  8.3420e-02,
         5.8997e-01,  2.7258e-02, -3.4975e-01, -1.8380e-01, -2.8744e-04,
        -1.9863e-02,  2.5660e-01,  2.5976e-02, -3.2665e-01, -5.5216e-01,
        -1.0612e-01, -8.7828e-02, -3.3475e-01, -9.2894e-02,  1.5286e-01,
        -5.0040e-01, -1.2594e+00,  3.0052e-03,  1.6066e+00,  2.0217e+00,
         2.0209e+00,  6.7476e-01,  1.6506e+00, -2.6817e+00, -3.3824e-02,
        -3.0674e-01,  1.2242e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.5031e-02,  2.6305e-01,  0.0000e+00, -1.1035e+00,
         6.1772e-01, -2.2042e+00,  1.4834e-01,  3.5943e-02,  0.0000e+00,
         0.0000e+00,  1.1816e-02, -1.7538e-01,  9.9392e-03, -5.9433e-02,
         4.2013e-02, -4.4646e-01, -3.5918e-01,  2.3720e-01,  2.6317e-01,
        -4.1316e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([2029]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([ 6.2642e-03,  6.7182e-02, -6.4165e-01,  3.5846e-01, -2.5759e-01,
        -4.6121e-01, -2.1794e+00, -1.0532e+00, -5.0706e-01, -3.2195e-01,
        -1.5071e-02,  4.0833e-03, -4.0119e-02, -5.0377e-02,  3.2950e-02,
         2.5575e-01, -1.9624e-01,  5.8189e-02,  1.8857e-01,  2.0410e-02,
         5.6067e-01, -8.3279e-02,  2.3434e-02, -2.9241e-01, -1.5860e-01,
        -6.7403e-03, -6.9119e-01, -9.8580e-01, -6.3083e-01,  3.5019e-02,
        -2.1587e-02, -8.3943e-02,  2.2857e-01, -5.2619e-03, -1.2769e-03,
        -5.1239e-01,  1.3431e-02, -7.3048e-01, -1.5444e-01, -1.0767e+00,
         9.0696e-03,  2.6169e-01,  1.9195e-02,  2.4653e-02,  7.3430e-03,
        -2.5199e-01,  9.6112e-01, -1.2186e-01,  3.9670e-01,  1.1515e+00,
         1.6549e+00, -8.2762e-01, -6.1543e-01, -8.2104e-01, -7.3789e-01,
         5.2873e-03, -1.0808e+00,  1.1631e+00, -2.7504e-03, -7.3552e-01,
        -4.3126e-03, -3.2616e-03,  7.3414e-03,  9.9719e-03, -7.7297e-03,
        -1.0633e-03,  4.0335e-02, -5.7112e+00,  7.2582e-01, -9.7144e-03,
        -1.2030e-01, -4.4965e-02, -7.9972e-02, -1.1711e-01,  9.2094e-03,
        -2.6444e-02,  1.6299e-03, -4.6931e-03,  3.7746e-04, -2.8744e-04,
         1.3632e-01, -2.4099e-01, -3.6805e-01,  7.0494e-01, -3.3731e-01,
        -3.1895e-03, -1.5419e-03,  3.1128e-02,  4.8253e-03,  1.0913e-01,
        -4.2202e-01, -3.7713e-01,  3.0052e-03, -1.3418e+00, -2.4070e+00,
        -9.2789e-01,  1.9075e+00, -1.6080e+00,  8.2921e-01, -9.7018e-01,
        -5.8507e-02,  1.3223e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  4.1613e-02,  5.8432e-01,  0.0000e+00, -2.3980e-01,
        -1.7502e-01, -1.5754e+00,  1.2281e-01,  3.5943e-02,  0.0000e+00,
         0.0000e+00,  1.3431e-02, -1.9908e-01,  9.9392e-03, -1.5549e-02,
         8.2946e-04, -7.8995e-04, -2.5634e-02,  2.8180e-01,  2.6638e-01,
        -3.9954e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1487]), tensor(-0.0517))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990]
INFO:main.py:Testing data year: 1991
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 6817
            device: cpu
            
2024-07-10 05:14:52,816	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 05:14:52,855	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 05:14:52,887	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 05:14:52,891	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 05:14:54,969	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 05:17:09,607	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_05-14-54' in 0.0883s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 115, 'num_layers': 1, 'num_embeddings': 6817, 'embedding_dim': 5, 'dropout_rate': 0.29337831653953017, 'lr': 0.0003, 'weight_decay': 0.001, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.021505168281703034
INFO:model_data_nn.py:Best trial testing loss: 0.04738619691012679
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_05-14-50_337719_632180/artifacts/2024-07-10_05-14-54/train_fnn_2024-07-10_05-14-54/driver_artifacts/train_fnn_0458f_00003_3_dropout_rate=0.2934,embedding_dim=5,hidden_dim=115,lr=0.0003,num_layers=1,weight_decay=0.0010_2024-07-10_05-14-55
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 115, 'num_layers': 1, 'num_embeddings': 7144, 'embedding_dim': 5, 'dropout_rate': 0.29337831653953017, 'lr': 0.0003, 'weight_decay': 0.001, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 11.415177491885125, 'avg_test_loss': 1.0287657758241058}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.4916024354219534, 'avg_test_loss': 0.047981268275649316}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.027755661565741455, 'avg_test_loss': 0.03864491714905667}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.024109415548157622, 'avg_test_loss': 0.03875302073736024}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.02426416973009186, 'avg_test_loss': 0.03923154807078742}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.024407165987348114, 'avg_test_loss': 0.03944469822110028}
INFO:model_data_nn.py:Early stopping at epoch 6
INFO:main.py:Making prediction for data in year: 1992
INFO:main.py:Prediction data shape: (47572,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1992: 0.1986208962010148
INFO:main.py:Prediction Stats:                 ret          pred
count  47572.000000  47572.000000
mean       0.021557      0.007630
std        0.196838      0.040017
min       -0.958333     -0.338531
25%       -0.064271     -0.000596
50%        0.000000      0.009406
75%        0.078377      0.021889
max        5.769231      0.448016
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991]
INFO:transform_data_nn.py:Train_data: (469809, 161)

INFO:transform_data_nn.py:Test data years: [1992]
INFO:transform_data_nn.py:Test_data: (47572, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992]
INFO:transform_data_nn.py:Retrain_data: (517381, 161)

INFO:transform_data_nn.py:Prediction data years: [1993]
INFO:transform_data_nn.py:Prediction_data: (50974, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([469809, 152])
            y_train_tf: torch.Size([469809])

            x_test_tf: torch.Size([47572, 152])
            y_test_tf: torch.Size([47572])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([517381, 152])
            y_retrain_tf: torch.Size([517381])

            x_prediction_tf: torch.Size([50974, 152])
            y_prediction_tf: torch.Size([50974])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.7234e-01,  4.6972e-01,  1.3369e-01, -1.3233e+00, -1.1615e-01,
        -6.5763e-01, -1.7787e-01, -3.5546e-01,  3.2117e-01, -1.5645e-01,
        -7.0541e-01, -1.5574e-03, -4.8483e-01, -1.7368e-01,  8.8285e-02,
         5.0900e-01, -1.2565e-01,  1.9820e-01, -8.7710e-02,  4.5217e-01,
        -3.6214e-01,  1.5567e-03,  1.2075e-02,  2.0896e-02, -5.7166e-02,
        -2.6419e-01, -5.6232e-01, -1.1018e-02,  3.9683e-01,  1.0666e+00,
         4.3934e-01, -8.5856e-02,  4.4396e-01, -5.2619e-03, -3.7864e-01,
        -1.8745e-01,  8.5812e-02,  5.7862e-01,  2.0035e-02, -1.1342e+00,
        -3.0314e-01,  3.5782e-01,  2.6210e-01, -9.0749e-02, -1.6322e-01,
        -6.7575e-01,  1.2232e-01, -7.2473e-02, -4.3025e-01, -1.6126e-01,
        -6.6996e-01,  6.6997e-01, -1.4319e-01, -4.9841e-02,  3.0161e-02,
         4.2920e-01, -7.5336e-01,  5.1860e-02, -2.4874e-01, -2.6112e-02,
         1.2572e-01, -3.1123e-01,  1.3579e-01,  2.5557e-01,  1.1514e-01,
        -1.4038e-01,  2.3383e-01, -9.0486e-02,  7.2582e-01, -4.2017e-01,
        -1.2030e-01, -4.4965e-02, -7.9972e-02, -8.0907e-01,  8.3420e-02,
         5.8997e-01,  2.7258e-02, -3.4975e-01, -1.8380e-01, -2.8744e-04,
        -1.9863e-02,  2.5660e-01,  2.5976e-02, -3.2665e-01, -5.5216e-01,
        -1.0612e-01, -8.7828e-02, -3.3475e-01, -9.2894e-02,  1.5286e-01,
        -5.0040e-01, -1.2594e+00,  3.0052e-03,  1.6066e+00,  2.0217e+00,
         2.0209e+00,  6.7476e-01,  1.6506e+00, -2.6817e+00, -3.3824e-02,
        -3.0674e-01,  1.2242e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.5031e-02,  2.6305e-01,  0.0000e+00, -1.1035e+00,
         6.1772e-01, -2.2042e+00,  1.4834e-01,  3.5943e-02,  0.0000e+00,
         0.0000e+00,  1.1816e-02, -1.7538e-01,  9.9392e-03, -5.9433e-02,
         4.2013e-02, -4.4646e-01, -3.5918e-01,  2.3720e-01,  2.6317e-01,
        -4.1316e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([2029]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 6.2642e-03,  6.7182e-02, -6.4165e-01,  3.5846e-01, -2.5759e-01,
        -4.6121e-01, -2.1794e+00, -1.0532e+00, -5.0706e-01, -3.2195e-01,
        -1.5071e-02,  4.0833e-03, -4.0119e-02, -5.0377e-02,  3.2950e-02,
         2.5575e-01, -1.9624e-01,  5.8189e-02,  1.8857e-01,  2.0410e-02,
         5.6067e-01, -8.3279e-02,  2.3434e-02, -2.9241e-01, -1.5860e-01,
        -6.7403e-03, -6.9119e-01, -9.8580e-01, -6.3083e-01,  3.5019e-02,
        -2.1587e-02, -8.3943e-02,  2.2857e-01, -5.2619e-03, -1.2769e-03,
        -5.1239e-01,  1.3431e-02, -7.3048e-01, -1.5444e-01, -1.0767e+00,
         9.0696e-03,  2.6169e-01,  1.9195e-02,  2.4653e-02,  7.3430e-03,
        -2.5199e-01,  9.6112e-01, -1.2186e-01,  3.9670e-01,  1.1515e+00,
         1.6549e+00, -8.2762e-01, -6.1543e-01, -8.2104e-01, -7.3789e-01,
         5.2873e-03, -1.0808e+00,  1.1631e+00, -2.7504e-03, -7.3552e-01,
        -4.3126e-03, -3.2616e-03,  7.3414e-03,  9.9719e-03, -7.7297e-03,
        -1.0633e-03,  4.0335e-02, -5.7112e+00,  7.2582e-01, -9.7144e-03,
        -1.2030e-01, -4.4965e-02, -7.9972e-02, -1.1711e-01,  9.2094e-03,
        -2.6444e-02,  1.6299e-03, -4.6931e-03,  3.7746e-04, -2.8744e-04,
         1.3632e-01, -2.4099e-01, -3.6805e-01,  7.0494e-01, -3.3731e-01,
        -3.1895e-03, -1.5419e-03,  3.1128e-02,  4.8253e-03,  1.0913e-01,
        -4.2202e-01, -3.7713e-01,  3.0052e-03, -1.3418e+00, -2.4070e+00,
        -9.2789e-01,  1.9075e+00, -1.6080e+00,  8.2921e-01, -9.7018e-01,
        -5.8507e-02,  1.3223e-02,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  4.1613e-02,  5.8432e-01,  0.0000e+00, -2.3980e-01,
        -1.7502e-01, -1.5754e+00,  1.2281e-01,  3.5943e-02,  0.0000e+00,
         0.0000e+00,  1.3431e-02, -1.9908e-01,  9.9392e-03, -1.5549e-02,
         8.2946e-04, -7.8995e-04, -2.5634e-02,  2.8180e-01,  2.6638e-01,
        -3.9954e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1487]), tensor(-0.0517))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.7017e-01,  5.4430e-01,  1.2009e-01, -1.3250e+00, -1.0880e-01,
        -6.7292e-01, -1.8004e-01, -3.5933e-01,  3.2668e-01, -1.5317e-01,
        -7.0589e-01,  7.4726e-03, -4.8743e-01, -2.2608e-01,  1.0144e-01,
         5.1039e-01, -1.2794e-01,  2.0643e-01, -1.0678e-01,  4.7095e-01,
        -3.3926e-01,  1.6034e-03,  1.7851e-02,  1.7928e-02, -5.3087e-02,
        -2.6831e-01, -5.6195e-01, -1.7845e-02,  3.8549e-01,  1.0970e+00,
         4.2313e-01, -8.9777e-02,  4.4965e-01, -1.3829e-02, -3.8024e-01,
        -1.8186e-01,  1.0190e-01,  5.8749e-01,  2.8611e-02, -1.1229e+00,
        -3.0893e-01,  3.1183e-01,  2.8781e-01, -8.9431e-02, -1.5191e-01,
        -6.8379e-01,  1.0111e-01, -7.6698e-02, -4.0679e-01, -1.6009e-01,
        -6.9287e-01,  6.6100e-01, -1.3563e-01, -3.9684e-02,  2.3737e-02,
         4.2900e-01, -7.4683e-01,  5.1487e-02, -2.5445e-01, -2.8726e-02,
         1.2699e-01, -3.1623e-01,  1.3253e-01,  2.5171e-01,  1.1643e-01,
        -1.4354e-01,  2.8767e-01, -1.0047e-01,  7.1446e-01, -4.1912e-01,
        -1.6563e-01, -6.4405e-02, -3.0634e-02, -8.1485e-01,  9.5358e-02,
         6.0610e-01,  2.5212e-02, -3.5232e-01, -1.8446e-01,  6.2203e-03,
        -2.2769e-02,  2.6777e-01,  2.8779e-02, -3.3119e-01, -5.5081e-01,
        -1.0952e-01, -9.1631e-02, -3.2660e-01, -8.1110e-02,  1.6108e-01,
        -4.9870e-01, -1.2566e+00,  4.5272e-03,  1.6870e+00,  1.9463e+00,
         2.1191e+00,  3.9819e-01,  1.6656e+00, -2.7099e+00,  7.7995e-02,
        -2.9821e-01,  1.3334e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.0548e-02,  3.9668e-01,  0.0000e+00, -1.1758e+00,
         6.5412e-01, -2.1153e+00,  1.5104e-01,  2.5704e-02,  0.0000e+00,
         0.0000e+00,  1.5606e-02, -1.6936e-01,  1.0378e-02, -6.9491e-02,
         4.7393e-02, -4.4982e-01, -3.5714e-01,  2.4907e-01,  2.6962e-01,
        -4.1738e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([2138]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([ 8.2728e-03,  5.4755e-02, -4.9370e-01,  5.4448e-01,  2.9865e-01,
        -6.0803e-01, -2.2079e+00, -1.0301e+00, -4.6674e-01, -2.4042e-01,
        -1.7592e-02,  4.2173e-03, -3.7468e-02, -4.0824e-02,  2.9185e-02,
        -1.0207e+00, -1.7753e-01,  6.2290e-01,  1.4153e-01,  1.1150e-02,
         7.8102e-01, -7.0740e-02, -2.0869e-02, -3.4765e-01,  1.4737e-01,
        -9.8068e-03, -6.4582e-01, -7.3177e-01, -1.2937e+00,  3.8182e-02,
        -2.6866e-02, -2.1075e-01,  1.8523e-01, -1.3829e-02,  1.1890e-03,
         1.3803e+00,  1.7985e-02, -7.3909e-01,  4.1833e-01, -1.0074e+00,
        -4.5112e-02, -2.2884e-01,  1.1162e-02,  3.1080e-02,  4.3183e-03,
        -5.2148e-01, -2.0603e-01, -1.8556e-01,  3.2134e-01,  5.6058e-01,
         1.6397e+00, -8.3847e-01, -5.9076e-01, -7.3768e-01, -7.3865e-01,
         2.3038e-03, -1.0761e+00, -4.3372e-02, -9.3552e-03,  2.7181e-01,
        -5.0712e-03, -9.1803e-03,  1.0368e-02,  1.4657e-02, -9.1383e-03,
         5.3932e-03,  3.0839e-02,  1.1480e+00,  5.0633e-02, -1.2962e-02,
        -1.6563e-01, -6.4405e-02, -3.0634e-02, -4.5080e-01,  8.8855e-03,
         2.7061e-02,  1.3338e-03, -4.3063e-03,  1.4568e-03,  6.2203e-03,
         1.1851e-01, -4.7181e-01, -3.6238e-01, -1.7764e-01, -5.0873e-01,
        -3.4696e-03, -2.0132e-03,  3.1328e-02,  3.6180e-03,  1.2567e-01,
        -6.3390e-01,  9.6623e-01,  4.5272e-03, -1.3421e+00, -1.5261e+00,
        -9.5565e-01,  1.8065e+00, -1.6348e+00,  1.2081e+00, -1.1387e+00,
        -2.9790e-01,  3.0578e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.3509e-02,  2.2757e-01,  0.0000e+00,  5.2594e-01,
        -3.2482e-02,  5.0274e-01,  1.0084e-01,  2.5704e-02,  0.0000e+00,
         0.0000e+00,  1.5330e-02,  2.4573e-02,  1.0378e-02, -8.7727e-03,
         6.8298e-03,  1.7210e-03, -2.3708e-02,  1.1407e-01,  1.7418e-01,
        -3.3056e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1599]), tensor(0.))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991]
INFO:main.py:Testing data year: 1992
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 7144
            device: cpu
            
2024-07-10 06:19:20,358	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 06:19:20,395	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 06:19:20,428	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 06:19:20,432	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 06:19:22,465	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 06:25:20,096	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_06-19-22' in 0.0846s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 45, 'num_layers': 2, 'num_embeddings': 7144, 'embedding_dim': 10, 'dropout_rate': 0.07256929214357004, 'lr': 0.0009, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.022341291348638586
INFO:model_data_nn.py:Best trial testing loss: 0.038234775625569845
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_06-19-18_117870_632180/artifacts/2024-07-10_06-19-22/train_fnn_2024-07-10_06-19-22/driver_artifacts/train_fnn_058e0_00013_13_dropout_rate=0.0726,embedding_dim=10,hidden_dim=45,lr=0.0009,num_layers=2,weight_decay=0.0001_2024-07-10_06-19-22
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 45, 'num_layers': 2, 'num_embeddings': 7524, 'embedding_dim': 10, 'dropout_rate': 0.07256929214357004, 'lr': 0.0009, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 5.632014409164529, 'avg_test_loss': 0.3103320687264204}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.3217406747300771, 'avg_test_loss': 0.07486728757619858}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.04671749183088246, 'avg_test_loss': 0.038442983562126755}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.025799700850068153, 'avg_test_loss': 0.037749709477648136}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.025709689770291838, 'avg_test_loss': 0.03761728568468243}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.02581111073234182, 'avg_test_loss': 0.0402661858452484}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.0255165077417971, 'avg_test_loss': 0.03868961348198354}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.024994175821730663, 'avg_test_loss': 0.03721453111153096}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.024537382231132634, 'avg_test_loss': 0.038835000162944194}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.024064982315464615, 'avg_test_loss': 0.03705676208250225}
INFO:model_data_nn.py:Epoch 11/40, metrics: {'avg_train_loss': 0.023810529484460545, 'avg_test_loss': 0.03729686227161437}
INFO:model_data_nn.py:Epoch 12/40, metrics: {'avg_train_loss': 0.023700957872345677, 'avg_test_loss': 0.03710970943327993}
INFO:model_data_nn.py:Epoch 13/40, metrics: {'avg_train_loss': 0.023650379038971325, 'avg_test_loss': 0.037147321356460455}
INFO:model_data_nn.py:Early stopping at epoch 13
INFO:main.py:Making prediction for data in year: 1993
INFO:main.py:Prediction data shape: (50974,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1993: 0.19289943821152683
INFO:main.py:Prediction Stats:                 ret          pred
count  50974.000000  50974.000000
mean       0.018012      0.008556
std        0.193299      0.022219
min       -0.950000     -0.313539
25%       -0.061224      0.003512
50%        0.000000      0.009808
75%        0.075000      0.017237
max       19.000000      0.180257
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992]
INFO:transform_data_nn.py:Train_data: (517381, 161)

INFO:transform_data_nn.py:Test data years: [1993]
INFO:transform_data_nn.py:Test_data: (50974, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993]
INFO:transform_data_nn.py:Retrain_data: (568355, 161)

INFO:transform_data_nn.py:Prediction data years: [1994]
INFO:transform_data_nn.py:Prediction_data: (56928, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([517381, 152])
            y_train_tf: torch.Size([517381])

            x_test_tf: torch.Size([50974, 152])
            y_test_tf: torch.Size([50974])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([568355, 152])
            y_retrain_tf: torch.Size([568355])

            x_prediction_tf: torch.Size([56928, 152])
            y_prediction_tf: torch.Size([56928])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-1.7017e-01,  5.4430e-01,  1.2009e-01, -1.3250e+00, -1.0880e-01,
        -6.7292e-01, -1.8004e-01, -3.5933e-01,  3.2668e-01, -1.5317e-01,
        -7.0589e-01,  7.4726e-03, -4.8743e-01, -2.2608e-01,  1.0144e-01,
         5.1039e-01, -1.2794e-01,  2.0643e-01, -1.0678e-01,  4.7095e-01,
        -3.3926e-01,  1.6034e-03,  1.7851e-02,  1.7928e-02, -5.3087e-02,
        -2.6831e-01, -5.6195e-01, -1.7845e-02,  3.8549e-01,  1.0970e+00,
         4.2313e-01, -8.9777e-02,  4.4965e-01, -1.3829e-02, -3.8024e-01,
        -1.8186e-01,  1.0190e-01,  5.8749e-01,  2.8611e-02, -1.1229e+00,
        -3.0893e-01,  3.1183e-01,  2.8781e-01, -8.9431e-02, -1.5191e-01,
        -6.8379e-01,  1.0111e-01, -7.6698e-02, -4.0679e-01, -1.6009e-01,
        -6.9287e-01,  6.6100e-01, -1.3563e-01, -3.9684e-02,  2.3737e-02,
         4.2900e-01, -7.4683e-01,  5.1487e-02, -2.5445e-01, -2.8726e-02,
         1.2699e-01, -3.1623e-01,  1.3253e-01,  2.5171e-01,  1.1643e-01,
        -1.4354e-01,  2.8767e-01, -1.0047e-01,  7.1446e-01, -4.1912e-01,
        -1.6563e-01, -6.4405e-02, -3.0634e-02, -8.1485e-01,  9.5358e-02,
         6.0610e-01,  2.5212e-02, -3.5232e-01, -1.8446e-01,  6.2203e-03,
        -2.2769e-02,  2.6777e-01,  2.8779e-02, -3.3119e-01, -5.5081e-01,
        -1.0952e-01, -9.1631e-02, -3.2660e-01, -8.1110e-02,  1.6108e-01,
        -4.9870e-01, -1.2566e+00,  4.5272e-03,  1.6870e+00,  1.9463e+00,
         2.1191e+00,  3.9819e-01,  1.6656e+00, -2.7099e+00,  7.7995e-02,
        -2.9821e-01,  1.3334e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  6.0548e-02,  3.9668e-01,  0.0000e+00, -1.1758e+00,
         6.5412e-01, -2.1153e+00,  1.5104e-01,  2.5704e-02,  0.0000e+00,
         0.0000e+00,  1.5606e-02, -1.6936e-01,  1.0378e-02, -6.9491e-02,
         4.7393e-02, -4.4982e-01, -3.5714e-01,  2.4907e-01,  2.6962e-01,
        -4.1738e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([2138]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([ 8.2728e-03,  5.4755e-02, -4.9370e-01,  5.4448e-01,  2.9865e-01,
        -6.0803e-01, -2.2079e+00, -1.0301e+00, -4.6674e-01, -2.4042e-01,
        -1.7592e-02,  4.2173e-03, -3.7468e-02, -4.0824e-02,  2.9185e-02,
        -1.0207e+00, -1.7753e-01,  6.2290e-01,  1.4153e-01,  1.1150e-02,
         7.8102e-01, -7.0740e-02, -2.0869e-02, -3.4765e-01,  1.4737e-01,
        -9.8068e-03, -6.4582e-01, -7.3177e-01, -1.2937e+00,  3.8182e-02,
        -2.6866e-02, -2.1075e-01,  1.8523e-01, -1.3829e-02,  1.1890e-03,
         1.3803e+00,  1.7985e-02, -7.3909e-01,  4.1833e-01, -1.0074e+00,
        -4.5112e-02, -2.2884e-01,  1.1162e-02,  3.1080e-02,  4.3183e-03,
        -5.2148e-01, -2.0603e-01, -1.8556e-01,  3.2134e-01,  5.6058e-01,
         1.6397e+00, -8.3847e-01, -5.9076e-01, -7.3768e-01, -7.3865e-01,
         2.3038e-03, -1.0761e+00, -4.3372e-02, -9.3552e-03,  2.7181e-01,
        -5.0712e-03, -9.1803e-03,  1.0368e-02,  1.4657e-02, -9.1383e-03,
         5.3932e-03,  3.0839e-02,  1.1480e+00,  5.0633e-02, -1.2962e-02,
        -1.6563e-01, -6.4405e-02, -3.0634e-02, -4.5080e-01,  8.8855e-03,
         2.7061e-02,  1.3338e-03, -4.3063e-03,  1.4568e-03,  6.2203e-03,
         1.1851e-01, -4.7181e-01, -3.6238e-01, -1.7764e-01, -5.0873e-01,
        -3.4696e-03, -2.0132e-03,  3.1328e-02,  3.6180e-03,  1.2567e-01,
        -6.3390e-01,  9.6623e-01,  4.5272e-03, -1.3421e+00, -1.5261e+00,
        -9.5565e-01,  1.8065e+00, -1.6348e+00,  1.2081e+00, -1.1387e+00,
        -2.9790e-01,  3.0578e-03,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.3509e-02,  2.2757e-01,  0.0000e+00,  5.2594e-01,
        -3.2482e-02,  5.0274e-01,  1.0084e-01,  2.5704e-02,  0.0000e+00,
         0.0000e+00,  1.5330e-02,  2.4573e-02,  1.0378e-02, -8.7727e-03,
         6.8298e-03,  1.7210e-03, -2.3708e-02,  1.1407e-01,  1.7418e-01,
        -3.3056e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([1599]), tensor(0.))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-0.1627,  0.6010,  0.1038, -1.3195, -0.1077, -0.6889, -0.1846, -0.3644,
         0.3499, -0.1543, -0.7057,  0.0199, -0.4946, -0.2654,  0.1087,  0.5055,
        -0.1315,  0.2150, -0.0945,  0.4776, -0.3486,  0.0089,  0.0158,  0.0140,
        -0.0544, -0.2740, -0.5624, -0.0210,  0.3631,  1.1413,  0.4124, -0.0923,
         0.4571, -0.0308, -0.3776, -0.1795,  0.1072,  0.6029,  0.0264, -1.1189,
        -0.3120,  0.2898,  0.2903, -0.0789, -0.1500, -0.6933,  0.0886, -0.0803,
        -0.4103, -0.1748, -0.7108,  0.6464, -0.1296, -0.0334,  0.0165,  0.4286,
        -0.7389,  0.0540, -0.2568, -0.0286,  0.1291, -0.3176,  0.1324,  0.2510,
         0.1132, -0.1444,  0.3252, -0.1086,  0.7002, -0.4200, -0.1987, -0.0793,
        -0.0307, -0.8240,  0.1070,  0.6206,  0.0225, -0.3558, -0.1857,  0.0109,
        -0.0137,  0.2642,  0.0456, -0.3309, -0.5521, -0.1139, -0.0965, -0.3181,
        -0.0679,  0.1737, -0.5012, -1.2574,  0.0050,  1.7440,  1.9886,  2.1932,
         0.2080,  1.6965, -2.8025,  0.1979, -0.2860,  0.1305,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0546,  0.4049,  0.0000, -1.2438,  0.6958, -2.1782,
         0.1527,  0.0333,  0.0000,  0.0000,  0.0255, -0.1674, -0.0181, -0.0734,
         0.0633, -0.4506, -0.3607,  0.2574,  0.2741, -0.4159,  0.0000,  0.0000,
         0.0000,  1.0000,  1.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([2319]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-1.0948e+00, -1.4187e-01, -7.2058e-01,  7.0985e-01, -6.6578e-02,
        -4.6301e-01, -2.1650e+00, -9.9081e-01, -5.6268e-01, -3.7237e-01,
        -5.6175e-01,  3.7101e-05,  9.5947e-02,  2.8784e-01, -2.1512e-01,
        -3.9485e-02, -2.1531e-01,  2.2903e-01, -9.4515e-02,  1.8356e-01,
        -1.2135e-01, -7.2470e-02, -3.7642e-01,  1.9283e-01,  9.4689e-02,
        -5.3174e-01, -5.9323e-01, -5.7247e-01, -1.0604e+00,  3.9414e-01,
        -4.2560e-01, -3.0528e-02,  2.4880e-01, -3.0761e-02, -7.3488e-01,
         5.0971e-03,  4.3622e-01, -7.4795e-01, -1.4185e-01, -9.4123e-01,
        -1.1536e-01, -1.7670e-01,  6.4292e-01, -2.7651e-01, -1.4653e-01,
        -1.5836e-01,  2.1074e-01,  5.7376e-01,  3.4323e-01, -5.5554e-02,
         6.7760e-02, -7.0632e-01, -5.8268e-01, -6.8310e-01, -7.3676e-01,
         4.4897e-01, -1.0707e+00,  3.6216e-01, -4.3375e-01,  1.7003e-01,
         3.9617e-01, -5.8368e-01, -3.9668e-01, -8.6361e-01, -1.3517e-02,
        -4.9807e-01, -2.2457e-02,  2.7572e+00,  1.3656e+00, -4.1959e-01,
        -1.9874e-01, -7.9300e-02, -3.0728e-02, -1.0945e-01,  4.2815e-02,
         5.0835e-02, -1.8702e-01, -1.3443e-01, -7.7930e-02,  1.0893e-02,
         1.0953e-01,  1.3195e-01, -3.8316e-01,  1.4495e+00,  3.9895e-01,
        -1.0099e-01, -8.8832e-02, -2.9090e-01, -5.4957e-01,  2.0784e-02,
        -6.7326e-02,  1.3281e-01,  5.0155e-03, -1.4115e+00, -1.1303e+00,
        -1.2368e+00,  1.8042e+00, -1.4370e+00,  7.5057e-01, -1.1416e+00,
        -3.2038e-01,  4.8890e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.7368e-02, -9.0724e-02,  0.0000e+00,  4.8731e-01,
        -2.0389e-01,  2.8708e-01,  1.3301e-01,  2.1381e+00,  0.0000e+00,
         0.0000e+00, -5.9914e-01, -1.8123e-01, -3.8569e+00,  7.0866e-01,
        -4.0496e-01, -4.6480e-01, -4.2385e-01,  2.4829e-01,  3.2808e-01,
        -3.5306e-01,  1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([488]), tensor(-0.0476))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992]
INFO:main.py:Testing data year: 1993
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 7524
            device: cpu
            
2024-07-10 07:35:03,881	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 07:35:03,918	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 07:35:03,950	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 07:35:03,955	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 07:35:06,201	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 07:37:31,545	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_07-35-06' in 0.0820s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 65, 'num_layers': 2, 'num_embeddings': 7524, 'embedding_dim': 5, 'dropout_rate': 0.3748726632012116, 'lr': 0.0005, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.026102227210891678
INFO:model_data_nn.py:Best trial testing loss: 0.037393908710218964
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_07-35-01_433541_632180/artifacts/2024-07-10_07-35-06/train_fnn_2024-07-10_07-35-06/driver_artifacts/train_fnn_99d52_00031_31_dropout_rate=0.3749,embedding_dim=5,hidden_dim=65,lr=0.0005,num_layers=2,weight_decay=0.0001_2024-07-10_07-35-06
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 65, 'num_layers': 2, 'num_embeddings': 8135, 'embedding_dim': 5, 'dropout_rate': 0.3748726632012116, 'lr': 0.0005, 'weight_decay': 0.0001, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 5.905903553349486, 'avg_test_loss': 0.04219637317123568}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.029448757348988896, 'avg_test_loss': 0.02746895218744139}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.026701594180419525, 'avg_test_loss': 0.025356828065948234}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.027080036631002453, 'avg_test_loss': 0.026731358114379405}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.027196967449728594, 'avg_test_loss': 0.02567678022160792}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.027125562640147694, 'avg_test_loss': 0.025296428011137274}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.02671904373957613, 'avg_test_loss': 0.02497650821162847}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.02625077108876467, 'avg_test_loss': 0.024656952841148917}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.025770748169561836, 'avg_test_loss': 0.02618669089547989}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.025434286671597132, 'avg_test_loss': 0.02775498024801903}
INFO:model_data_nn.py:Epoch 11/40, metrics: {'avg_train_loss': 0.025295994766157175, 'avg_test_loss': 0.03346630063267099}
INFO:model_data_nn.py:Early stopping at epoch 11
INFO:main.py:Making prediction for data in year: 1994
INFO:main.py:Prediction data shape: (56928,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1994: 0.1829701958807113
INFO:main.py:Prediction Stats:                 ret          pred
count  56928.000000  56928.000000
mean      -0.002534     -0.005751
std        0.157461      0.100375
min       -0.937500    -12.974471
25%       -0.071429     -0.010757
50%       -0.005882      0.003672
75%        0.054054      0.010354
max       12.500000      0.176354
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993]
INFO:transform_data_nn.py:Train_data: (568355, 161)

INFO:transform_data_nn.py:Test data years: [1994]
INFO:transform_data_nn.py:Test_data: (56928, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994]
INFO:transform_data_nn.py:Retrain_data: (625283, 161)

INFO:transform_data_nn.py:Prediction data years: [1995]
INFO:transform_data_nn.py:Prediction_data: (64688, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([568355, 152])
            y_train_tf: torch.Size([568355])

            x_test_tf: torch.Size([56928, 152])
            y_test_tf: torch.Size([56928])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([625283, 152])
            y_retrain_tf: torch.Size([625283])

            x_prediction_tf: torch.Size([64688, 152])
            y_prediction_tf: torch.Size([64688])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-0.1627,  0.6010,  0.1038, -1.3195, -0.1077, -0.6889, -0.1846, -0.3644,
         0.3499, -0.1543, -0.7057,  0.0199, -0.4946, -0.2654,  0.1087,  0.5055,
        -0.1315,  0.2150, -0.0945,  0.4776, -0.3486,  0.0089,  0.0158,  0.0140,
        -0.0544, -0.2740, -0.5624, -0.0210,  0.3631,  1.1413,  0.4124, -0.0923,
         0.4571, -0.0308, -0.3776, -0.1795,  0.1072,  0.6029,  0.0264, -1.1189,
        -0.3120,  0.2898,  0.2903, -0.0789, -0.1500, -0.6933,  0.0886, -0.0803,
        -0.4103, -0.1748, -0.7108,  0.6464, -0.1296, -0.0334,  0.0165,  0.4286,
        -0.7389,  0.0540, -0.2568, -0.0286,  0.1291, -0.3176,  0.1324,  0.2510,
         0.1132, -0.1444,  0.3252, -0.1086,  0.7002, -0.4200, -0.1987, -0.0793,
        -0.0307, -0.8240,  0.1070,  0.6206,  0.0225, -0.3558, -0.1857,  0.0109,
        -0.0137,  0.2642,  0.0456, -0.3309, -0.5521, -0.1139, -0.0965, -0.3181,
        -0.0679,  0.1737, -0.5012, -1.2574,  0.0050,  1.7440,  1.9886,  2.1932,
         0.2080,  1.6965, -2.8025,  0.1979, -0.2860,  0.1305,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0546,  0.4049,  0.0000, -1.2438,  0.6958, -2.1782,
         0.1527,  0.0333,  0.0000,  0.0000,  0.0255, -0.1674, -0.0181, -0.0734,
         0.0633, -0.4506, -0.3607,  0.2574,  0.2741, -0.4159,  0.0000,  0.0000,
         0.0000,  1.0000,  1.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([2319]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-1.0948e+00, -1.4187e-01, -7.2058e-01,  7.0985e-01, -6.6578e-02,
        -4.6301e-01, -2.1650e+00, -9.9081e-01, -5.6268e-01, -3.7237e-01,
        -5.6175e-01,  3.7101e-05,  9.5947e-02,  2.8784e-01, -2.1512e-01,
        -3.9485e-02, -2.1531e-01,  2.2903e-01, -9.4515e-02,  1.8356e-01,
        -1.2135e-01, -7.2470e-02, -3.7642e-01,  1.9283e-01,  9.4689e-02,
        -5.3174e-01, -5.9323e-01, -5.7247e-01, -1.0604e+00,  3.9414e-01,
        -4.2560e-01, -3.0528e-02,  2.4880e-01, -3.0761e-02, -7.3488e-01,
         5.0971e-03,  4.3622e-01, -7.4795e-01, -1.4185e-01, -9.4123e-01,
        -1.1536e-01, -1.7670e-01,  6.4292e-01, -2.7651e-01, -1.4653e-01,
        -1.5836e-01,  2.1074e-01,  5.7376e-01,  3.4323e-01, -5.5554e-02,
         6.7760e-02, -7.0632e-01, -5.8268e-01, -6.8310e-01, -7.3676e-01,
         4.4897e-01, -1.0707e+00,  3.6216e-01, -4.3375e-01,  1.7003e-01,
         3.9617e-01, -5.8368e-01, -3.9668e-01, -8.6361e-01, -1.3517e-02,
        -4.9807e-01, -2.2457e-02,  2.7572e+00,  1.3656e+00, -4.1959e-01,
        -1.9874e-01, -7.9300e-02, -3.0728e-02, -1.0945e-01,  4.2815e-02,
         5.0835e-02, -1.8702e-01, -1.3443e-01, -7.7930e-02,  1.0893e-02,
         1.0953e-01,  1.3195e-01, -3.8316e-01,  1.4495e+00,  3.9895e-01,
        -1.0099e-01, -8.8832e-02, -2.9090e-01, -5.4957e-01,  2.0784e-02,
        -6.7326e-02,  1.3281e-01,  5.0155e-03, -1.4115e+00, -1.1303e+00,
        -1.2368e+00,  1.8042e+00, -1.4370e+00,  7.5057e-01, -1.1416e+00,
        -3.2038e-01,  4.8890e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  3.7368e-02, -9.0724e-02,  0.0000e+00,  4.8731e-01,
        -2.0389e-01,  2.8708e-01,  1.3301e-01,  2.1381e+00,  0.0000e+00,
         0.0000e+00, -5.9914e-01, -1.8123e-01, -3.8569e+00,  7.0866e-01,
        -4.0496e-01, -4.6480e-01, -4.2385e-01,  2.4829e-01,  3.2808e-01,
        -3.5306e-01,  1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([488]), tensor(-0.0476))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-0.1577,  0.6453,  0.0969, -1.3052, -0.1139, -0.7019, -0.1833, -0.3657,
         0.3767, -0.1564, -0.7027,  0.0357, -0.4985, -0.2952,  0.1126,  0.5035,
        -0.1339,  0.2252, -0.0874,  0.4801, -0.3405,  0.0155,  0.0080,  0.0090,
        -0.0575, -0.2752, -0.5657, -0.0178,  0.3429,  1.1855,  0.4104, -0.0981,
         0.4655, -0.0238, -0.3644, -0.1862,  0.1035,  0.6340,  0.0177, -1.1194,
        -0.3136,  0.3177,  0.2852, -0.0695, -0.1550, -0.7002,  0.0979, -0.0723,
        -0.4205, -0.1636, -0.7271,  0.6331, -0.1250, -0.0247,  0.0110,  0.4260,
        -0.7312,  0.0713, -0.2568, -0.0265,  0.1289, -0.3170,  0.1312,  0.2541,
         0.1071, -0.1490,  0.3530, -0.1167,  0.6825, -0.4193, -0.2245, -0.0319,
        -0.0325, -0.8322,  0.1209,  0.6343,  0.0206, -0.3592, -0.1850,  0.0147,
        -0.0055,  0.2536,  0.0685, -0.3348, -0.5537, -0.1190, -0.1021, -0.3105,
        -0.0476,  0.1767, -0.5039, -1.2578,  0.0097,  1.8202,  2.0971,  2.2607,
         0.0844,  1.7846, -2.9385,  0.3121, -0.2769,  0.1251,  0.0000, -1.3687,
         0.0000,  2.5697,  0.0523,  0.4312,  0.0000, -1.3243,  0.7496, -2.3021,
         0.1531,  0.0370,  0.0000, -0.4823,  0.0434, -0.1689,  0.0072, -0.0806,
         0.0807, -0.4368, -0.3565,  0.2660,  0.2791, -0.4143,  0.0000,  0.0000,
         0.0000,  1.0000,  1.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([2621]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-4.8066e-01, -5.3158e-01, -7.6841e-01,  8.6130e-01, -2.9824e-01,
        -2.2998e-01, -1.5583e+00, -9.7009e-01, -4.2586e-01, -3.5658e-01,
        -6.7166e-01,  3.1419e-04, -1.0122e-02,  5.5465e-01, -7.0534e-02,
        -4.6088e-01, -1.7403e-01,  4.1837e-01, -8.7361e-02, -7.1934e-02,
         1.0543e-03, -6.5737e-02, -1.4886e-01, -2.2623e-01, -5.5274e-02,
        -5.5608e-01, -5.8789e-01, -1.7779e-02, -1.3612e+00,  6.9908e-01,
        -2.9599e-02, -1.1618e-01,  2.4594e-01, -2.3766e-02, -7.5812e-01,
         6.2633e-04,  3.3862e-02, -7.4003e-01,  3.1846e-01, -8.3698e-01,
         2.0403e-01, -1.1175e+00,  1.0480e-01, -2.3817e-01, -3.0323e-01,
        -4.0674e-01, -3.7382e-01, -3.1333e-01,  3.7712e-02, -2.2814e-01,
         1.5775e+00, -7.7847e-01, -4.7933e-01, -6.4357e-01, -7.3522e-01,
         3.6407e-01, -1.0666e+00,  1.1197e-01, -3.2990e-01, -2.1675e-01,
         1.1525e-01, -4.1919e-01, -1.9774e-01,  2.1786e-01, -1.4641e-02,
        -4.3009e-01, -2.6660e-01,  6.9628e-01,  1.3476e+00, -4.6254e-01,
        -2.2454e-01, -3.1857e-02, -3.2545e-02, -1.0438e-01,  3.7271e-02,
        -3.0687e-01, -1.0035e-01, -1.8808e-01, -5.0568e-02,  1.4729e-02,
        -5.4953e-03, -5.0477e-01, -3.4215e-01, -4.9930e-01, -6.5569e-01,
        -1.0229e-01, -9.2467e-02, -3.2483e-01, -6.4822e-01,  1.1650e-01,
        -7.0002e-01,  4.9078e-01,  9.7207e-03, -9.8185e-01, -5.1013e-02,
        -1.1580e+00,  3.5138e-01, -4.4943e-01, -2.9017e-02, -1.2657e+00,
        -2.3464e-01, -2.5423e-01,  0.0000e+00, -1.3687e+00,  0.0000e+00,
         2.5697e+00,  2.0467e-02, -1.9099e-01,  0.0000e+00, -1.7541e-01,
        -4.9659e-01,  8.8398e-01,  1.2988e-01,  7.7985e-01,  0.0000e+00,
        -4.8228e-01, -4.5178e-01, -1.9502e-01, -3.7534e+00,  7.7595e-01,
         2.9813e-01, -5.3571e-01, -4.7830e-01,  2.0182e-01,  2.6188e-01,
        -3.6246e-01,  1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([549]), tensor(-0.0312))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993]
INFO:main.py:Testing data year: 1994
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 8135
            device: cpu
            
2024-07-10 08:53:43,625	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 08:53:43,657	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 08:53:43,685	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_97410483204cf09a.zip' (1.26MiB) to Ray cluster...
2024-07-10 08:53:43,690	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_97410483204cf09a.zip'.
2024-07-10 08:53:45,917	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 08:57:23,238	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_08-53-45' in 0.0861s.
INFO:model_data_nn.py:Best trial config: {'continuous_dim': 151, 'hidden_dim': 5, 'num_layers': 4, 'num_embeddings': 8135, 'embedding_dim': 15, 'dropout_rate': 0.11737489820795478, 'lr': 0.0007, 'weight_decay': 1e-06, 'num_epochs': 40, 'num_gpus': 0}
INFO:model_data_nn.py:Best trial training loss: 0.02651472441023505
INFO:model_data_nn.py:Best trial testing loss: 0.02499309153141529
INFO:main.py:Ray Tune results have been saved to: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
INFO:main.py:Best trial directory: /tmp/ray/session_2024-07-10_08-53-41_273452_632180/artifacts/2024-07-10_08-53-45/train_fnn_2024-07-10_08-53-45/driver_artifacts/train_fnn_9700b_00012_12_dropout_rate=0.1174,embedding_dim=15,hidden_dim=5,lr=0.0007,num_layers=4,weight_decay=0.0000_2024-07-10_08-53-46
INFO:main.py:

Retrain a new model with data in years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994]

            Using the optimized hyperparameters: {'continuous_dim': 151, 'hidden_dim': 5, 'num_layers': 4, 'num_embeddings': 9176, 'embedding_dim': 15, 'dropout_rate': 0.11737489820795478, 'lr': 0.0007, 'weight_decay': 1e-06, 'num_epochs': 40, 'num_gpus': 0}

INFO:model_data_nn.py:Epoch 1/40, metrics: {'avg_train_loss': 12.324506431842407, 'avg_test_loss': 0.4676036473967341}
INFO:model_data_nn.py:Epoch 2/40, metrics: {'avg_train_loss': 0.48408123069472164, 'avg_test_loss': 0.2213182719682045}
INFO:model_data_nn.py:Epoch 3/40, metrics: {'avg_train_loss': 0.14509500506266532, 'avg_test_loss': 0.06842994805528477}
INFO:model_data_nn.py:Epoch 4/40, metrics: {'avg_train_loss': 0.050502902953578614, 'avg_test_loss': 0.03081127928511015}
INFO:model_data_nn.py:Epoch 5/40, metrics: {'avg_train_loss': 0.029095773422740615, 'avg_test_loss': 0.027207718315449627}
INFO:model_data_nn.py:Epoch 6/40, metrics: {'avg_train_loss': 0.02646087784841626, 'avg_test_loss': 0.027141288003843765}
INFO:model_data_nn.py:Epoch 7/40, metrics: {'avg_train_loss': 0.026373427446262178, 'avg_test_loss': 0.027119210834721685}
INFO:model_data_nn.py:Epoch 8/40, metrics: {'avg_train_loss': 0.02625131304480663, 'avg_test_loss': 0.027183195627607376}
INFO:model_data_nn.py:Epoch 9/40, metrics: {'avg_train_loss': 0.025833607831991966, 'avg_test_loss': 0.02722843396090884}
INFO:model_data_nn.py:Epoch 10/40, metrics: {'avg_train_loss': 0.02555070911060273, 'avg_test_loss': 0.027427865289843718}
INFO:model_data_nn.py:Early stopping at epoch 10
INFO:main.py:Making prediction for data in year: 1995
INFO:main.py:Prediction data shape: (64688,)
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py:346: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  prediction_data['pred'] = predictions
INFO:main.py:Root Mean Squared Error for Prediction in 1995: 0.16564386145805504
INFO:main.py:Prediction Stats:                 ret          pred
count  64688.000000  64688.000000
mean       0.023566     -0.001978
std        0.164422      0.026148
min       -0.885714     -0.127330
25%       -0.048029     -0.016989
50%        0.012255     -0.002866
75%        0.078947      0.009799
max        6.000000      0.288316
INFO:main.py:

Transform data

INFO:transform_data_nn.py:Train data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994]
INFO:transform_data_nn.py:Train_data: (625283, 161)

INFO:transform_data_nn.py:Test data years: [1995]
INFO:transform_data_nn.py:Test_data: (64688, 161)

INFO:transform_data_nn.py:Retrain data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995]
INFO:transform_data_nn.py:Retrain_data: (689971, 161)

INFO:transform_data_nn.py:Prediction data years: [1996]
INFO:transform_data_nn.py:Prediction_data: (66364, 161)

INFO:main.py:

Generate X and y with train_data and test_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_train_tf: torch.Size([625283, 152])
            y_train_tf: torch.Size([625283])

            x_test_tf: torch.Size([64688, 152])
            y_test_tf: torch.Size([64688])

        
INFO:main.py:

Generate X and y with retrain_data and prediction_data

/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1140: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1145: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/sklearn/utils/extmath.py:1165: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
INFO:main.py:
            x_retrain_tf: torch.Size([689971, 152])
            y_retrain_tf: torch.Size([689971])

            x_prediction_tf: torch.Size([66364, 152])
            y_prediction_tf: torch.Size([66364])

        
INFO:main.py:

Create dataset

INFO:main.py:Create train_dataset
INFO:main.py:train_dataset first example: (tensor([-0.1577,  0.6453,  0.0969, -1.3052, -0.1139, -0.7019, -0.1833, -0.3657,
         0.3767, -0.1564, -0.7027,  0.0357, -0.4985, -0.2952,  0.1126,  0.5035,
        -0.1339,  0.2252, -0.0874,  0.4801, -0.3405,  0.0155,  0.0080,  0.0090,
        -0.0575, -0.2752, -0.5657, -0.0178,  0.3429,  1.1855,  0.4104, -0.0981,
         0.4655, -0.0238, -0.3644, -0.1862,  0.1035,  0.6340,  0.0177, -1.1194,
        -0.3136,  0.3177,  0.2852, -0.0695, -0.1550, -0.7002,  0.0979, -0.0723,
        -0.4205, -0.1636, -0.7271,  0.6331, -0.1250, -0.0247,  0.0110,  0.4260,
        -0.7312,  0.0713, -0.2568, -0.0265,  0.1289, -0.3170,  0.1312,  0.2541,
         0.1071, -0.1490,  0.3530, -0.1167,  0.6825, -0.4193, -0.2245, -0.0319,
        -0.0325, -0.8322,  0.1209,  0.6343,  0.0206, -0.3592, -0.1850,  0.0147,
        -0.0055,  0.2536,  0.0685, -0.3348, -0.5537, -0.1190, -0.1021, -0.3105,
        -0.0476,  0.1767, -0.5039, -1.2578,  0.0097,  1.8202,  2.0971,  2.2607,
         0.0844,  1.7846, -2.9385,  0.3121, -0.2769,  0.1251,  0.0000, -1.3687,
         0.0000,  2.5697,  0.0523,  0.4312,  0.0000, -1.3243,  0.7496, -2.3021,
         0.1531,  0.0370,  0.0000, -0.4823,  0.0434, -0.1689,  0.0072, -0.0806,
         0.0807, -0.4368, -0.3565,  0.2660,  0.2791, -0.4143,  0.0000,  0.0000,
         0.0000,  1.0000,  1.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000]), tensor([2621]), tensor(0.2117))
INFO:main.py:Create test_dataset
INFO:main.py:test_dataset first example: (tensor([-4.8066e-01, -5.3158e-01, -7.6841e-01,  8.6130e-01, -2.9824e-01,
        -2.2998e-01, -1.5583e+00, -9.7009e-01, -4.2586e-01, -3.5658e-01,
        -6.7166e-01,  3.1419e-04, -1.0122e-02,  5.5465e-01, -7.0534e-02,
        -4.6088e-01, -1.7403e-01,  4.1837e-01, -8.7361e-02, -7.1934e-02,
         1.0543e-03, -6.5737e-02, -1.4886e-01, -2.2623e-01, -5.5274e-02,
        -5.5608e-01, -5.8789e-01, -1.7779e-02, -1.3612e+00,  6.9908e-01,
        -2.9599e-02, -1.1618e-01,  2.4594e-01, -2.3766e-02, -7.5812e-01,
         6.2633e-04,  3.3862e-02, -7.4003e-01,  3.1846e-01, -8.3698e-01,
         2.0403e-01, -1.1175e+00,  1.0480e-01, -2.3817e-01, -3.0323e-01,
        -4.0674e-01, -3.7382e-01, -3.1333e-01,  3.7712e-02, -2.2814e-01,
         1.5775e+00, -7.7847e-01, -4.7933e-01, -6.4357e-01, -7.3522e-01,
         3.6407e-01, -1.0666e+00,  1.1197e-01, -3.2990e-01, -2.1675e-01,
         1.1525e-01, -4.1919e-01, -1.9774e-01,  2.1786e-01, -1.4641e-02,
        -4.3009e-01, -2.6660e-01,  6.9628e-01,  1.3476e+00, -4.6254e-01,
        -2.2454e-01, -3.1857e-02, -3.2545e-02, -1.0438e-01,  3.7271e-02,
        -3.0687e-01, -1.0035e-01, -1.8808e-01, -5.0568e-02,  1.4729e-02,
        -5.4953e-03, -5.0477e-01, -3.4215e-01, -4.9930e-01, -6.5569e-01,
        -1.0229e-01, -9.2467e-02, -3.2483e-01, -6.4822e-01,  1.1650e-01,
        -7.0002e-01,  4.9078e-01,  9.7207e-03, -9.8185e-01, -5.1013e-02,
        -1.1580e+00,  3.5138e-01, -4.4943e-01, -2.9017e-02, -1.2657e+00,
        -2.3464e-01, -2.5423e-01,  0.0000e+00, -1.3687e+00,  0.0000e+00,
         2.5697e+00,  2.0467e-02, -1.9099e-01,  0.0000e+00, -1.7541e-01,
        -4.9659e-01,  8.8398e-01,  1.2988e-01,  7.7985e-01,  0.0000e+00,
        -4.8228e-01, -4.5178e-01, -1.9502e-01, -3.7534e+00,  7.7595e-01,
         2.9813e-01, -5.3571e-01, -4.7830e-01,  2.0182e-01,  2.6188e-01,
        -3.6246e-01,  1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([549]), tensor(-0.0312))
INFO:main.py:Create retrain_dataset
INFO:main.py:retrain_dataset first example: (tensor([-1.5115e-01,  6.7878e-01,  8.6460e-02, -1.2846e+00, -1.2093e-01,
        -7.1391e-01, -1.7670e-01, -3.6376e-01,  4.0088e-01, -1.6083e-01,
        -6.9722e-01,  4.7871e-02, -4.9641e-01, -3.2117e-01,  1.1761e-01,
         4.9977e-01, -1.3510e-01,  2.3261e-01, -8.1522e-02,  4.7643e-01,
        -3.6452e-01,  8.5700e-03, -1.6375e-02,  2.7922e-03, -5.7475e-02,
        -2.7246e-01, -5.7264e-01, -1.7562e-02,  3.2162e-01,  1.2292e+00,
         4.0564e-01, -1.0071e-01,  4.7209e-01, -2.1404e-02, -3.4663e-01,
        -1.9729e-01,  9.3637e-02,  6.7096e-01,  6.0137e-03, -1.1201e+00,
        -3.1364e-01,  3.3389e-01,  2.7511e-01, -6.6658e-02, -1.6334e-01,
        -7.0643e-01,  1.0276e-01, -7.9072e-02, -4.1991e-01, -1.7377e-01,
        -7.4343e-01,  6.2106e-01, -1.1911e-01, -1.8509e-02, -5.8326e-04,
         4.2330e-01, -7.1753e-01,  7.7758e-02, -2.5199e-01, -1.6758e-02,
         1.2850e-01, -3.1115e-01,  1.3145e-01,  2.5882e-01,  1.0167e-01,
        -1.5566e-01,  3.7438e-01, -1.2248e-01,  6.7024e-01, -4.1602e-01,
        -2.4363e-01, -4.1873e-02,  1.0253e-02, -8.3795e-01,  1.3184e-01,
         6.4058e-01,  1.7745e-02, -3.6379e-01, -1.8291e-01,  1.5171e-02,
        -5.9800e-03,  2.4079e-01,  9.0698e-02, -3.3896e-01, -5.5515e-01,
        -1.2394e-01, -1.0768e-01, -3.0361e-01, -2.4351e-02,  1.7289e-01,
        -5.0532e-01, -1.2586e+00,  1.1638e-02,  1.8495e+00,  2.2177e+00,
         2.3412e+00,  7.3758e-02,  1.9010e+00, -2.9626e+00,  4.2520e-01,
        -2.6368e-01,  1.1265e-01,  8.7652e-01,  2.0998e-01, -2.8435e-01,
         3.2755e-01,  4.8188e-02,  3.4251e-01,  0.0000e+00, -1.3148e+00,
         8.3954e-01, -2.4254e+00,  1.5367e-01,  5.6624e-02,  0.0000e+00,
        -1.7589e-01,  7.0891e-02, -1.7468e-01, -7.7470e-03, -9.1207e-02,
         9.3465e-02, -4.1693e-01, -3.4837e-01,  2.7132e-01,  2.8253e-01,
        -4.1336e-01,  0.0000e+00,  0.0000e+00,  0.0000e+00,  1.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([2862]), tensor(0.2117))
INFO:main.py:Create prediction_dataset
INFO:main.py:prediction_dataset first example: (tensor([-3.4436e-01, -5.7929e-01, -5.1359e-01,  1.0057e+00, -8.1645e-02,
        -1.9217e-01, -6.2659e-01, -6.4998e-01, -4.6026e-01, -4.1355e-01,
        -7.1484e-01,  2.1049e-02, -1.3242e-01,  5.6856e-01,  1.4881e-01,
         6.9657e-02, -2.1576e-01,  3.3217e-01, -1.9636e-01,  1.4227e-01,
         2.0832e-01, -6.1980e-02, -2.1628e-02, -2.2795e-01,  9.1561e-02,
        -5.9874e-01, -6.0964e-01, -1.7562e-02, -1.3131e+00,  6.1630e-01,
        -4.4554e-01, -6.0665e-02,  2.4826e-01, -2.1404e-02, -7.3475e-01,
        -5.8997e-02,  2.5754e-01, -7.4060e-01, -6.5291e-02, -8.8391e-01,
        -1.2951e-02,  2.1373e-01,  2.6887e-01, -2.5199e-01, -1.5242e-01,
         1.9085e-01, -6.0896e-04,  5.1835e-01, -1.2395e-01,  4.5563e-02,
         1.5505e+00, -7.0046e-01, -5.8815e-01, -6.1109e-01, -7.3629e-01,
         3.9249e-01, -1.0568e+00,  3.6373e-01, -5.0217e-01, -3.7325e-01,
         1.0860e-01, -5.2731e-01, -2.1279e-01,  6.5980e-02, -1.5879e-02,
        -4.0546e-01, -2.6970e-01, -5.8012e-02,  1.3366e+00, -5.0869e-01,
        -2.4363e-01, -4.1873e-02,  1.0253e-02,  6.2562e-02,  5.6102e-02,
        -8.0481e-02,  8.5257e-02, -2.2827e-01, -5.2710e-02,  1.5171e-02,
         1.2069e-01, -6.1242e-02, -3.4225e-01,  1.1214e+00, -4.0444e-01,
        -1.0315e-01, -9.6106e-02, -3.4683e-01, -5.6943e-01,  2.5184e-01,
        -5.2606e-01, -6.4604e-01,  1.1638e-02, -1.8631e+00, -6.1791e-01,
        -1.1931e+00,  3.0440e-01, -5.8663e-01, -1.0121e+00, -1.0404e+00,
        -1.9768e-01,  9.6121e-02,  8.7652e-01, -3.5540e+00, -2.8435e-01,
         5.7011e+00,  2.1198e-02,  5.5717e-01,  0.0000e+00, -3.3296e-01,
        -8.1562e-01,  4.5206e-01,  1.3306e-01,  1.2583e+00,  0.0000e+00,
        -1.7589e-01, -3.9161e-01, -1.5439e-01, -3.7189e+00,  7.2864e-01,
         4.8963e-02, -4.9380e-01, -5.1432e-01,  2.2382e-01,  2.8417e-01,
        -3.8725e-01,  1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  1.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         1.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,
         0.0000e+00]), tensor([552]), tensor(-0.0267))
INFO:main.py:

Create dataloader

INFO:main.py:Create train and test dataloader
INFO:main.py:Create retrain and prediction dataloader
INFO:main.py:

Hyperparameters tuning with Ray Tune

INFO:main.py:Training data years: [1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994]
INFO:main.py:Testing data year: 1995
INFO:main.py:

            ray_results_path: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results
            num_samples: 32
            max_num_epochs: 40
            num_cpus: 32
            cpus_per_trial: 1
            num_gpus: 0
            gpus_per_trial: 0
            continuous_dim: 151
            num_embeddings: 9176
            device: cpu
            
2024-07-10 10:20:28,727	INFO worker.py:1753 -- Started a local Ray instance.
2024-07-10 10:20:28,765	INFO packaging.py:530 -- Creating a file package for local directory '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src'.
2024-07-10 10:20:28,797	INFO packaging.py:358 -- Pushing file package 'gcs://_ray_pkg_46d7531d8a5486e4.zip' (1.26MiB) to Ray cluster...
2024-07-10 10:20:28,802	INFO packaging.py:371 -- Successfully pushed file package 'gcs://_ray_pkg_46d7531d8a5486e4.zip'.
2024-07-10 10:20:31,210	WARNING tune.py:902 -- AIR_VERBOSITY is set, ignoring passed-in ProgressReporter for now.
2024-07-10 10:20:38,137	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00030
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 577b3bbbfb8a4956c23b481101000000
	pid: 1642147
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,152	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00002
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: b958bb47693aa7b4cf68415d01000000
	pid: 1640644
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,156	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00010
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: a219192e6ced8f4c55d6e7d501000000
	pid: 1641119
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,160	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00000
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: a7ea3ff08699b061a9c99dcb01000000
	pid: 1640492
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,163	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00004
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 12dbf016f6fd0be260694f3601000000
	pid: 1640712
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,167	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00019
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: bb9fef77cca52737b99499c101000000
	pid: 1641672
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,170	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00008
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: efa5c66884bdcd86439d57b301000000
	pid: 1640844
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,172	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00005
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 113df1daa1517e3df62b496a01000000
	pid: 1640732
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,174	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00027
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 400ee636b11a26408c36b50d01000000
	pid: 1642016
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,177	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00020
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: f10e6130898497467ac7487701000000
	pid: 1641751
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,180	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00025
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 27c92781ce55740cd04601f501000000
	pid: 1642014
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,182	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00022
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 081d37d7680318bae7f61e6001000000
	pid: 1641883
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,185	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00015
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: ccb9ab02db5f4128804b8b1701000000
	pid: 1641263
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,189	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00016
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: c49c5ac36a759e682676601c01000000
	pid: 1641312
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,193	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00013
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 1cba7b5d181fab7d04bac07001000000
	pid: 1641220
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,196	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00024
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 8e44b4ce1be6f243617d59a801000000
	pid: 1642004
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,198	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00007
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: d4f3a2987a64f88e82069c3c01000000
	pid: 1640835
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,200	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00018
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 121e96890efac7b8cfc2ef9101000000
	pid: 1641557
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,202	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00029
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 1eed7a75b7cd6513ddb73ade01000000
	pid: 1642018
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,204	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00026
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 6958c95bd22b221ed786458801000000
	pid: 1642015
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,206	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00014
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: f97d7a9fece2edc859e0b2ad01000000
	pid: 1641231
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,208	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00028
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 05744e9f89b6b235643a038a01000000
	pid: 1642017
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,210	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00003
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 0675e6568018b5162793aa0e01000000
	pid: 1640662
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,211	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00001
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 2434980b3fc8f8105eb12d2601000000
	pid: 1640521
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,214	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00017
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 9f4077586eed365cb07745c201000000
	pid: 1641414
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,216	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00023
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: fd99d68d86445722b38672eb01000000
	pid: 1641928
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,218	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00012
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 6647a3c99b7dbaaabb7d8d8601000000
	pid: 1641185
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,220	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00009
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 3c7adc902202f37996414fdf01000000
	pid: 1641082
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,223	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00031
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 3ef515c9ef86836da1378a1201000000
	pid: 1642148
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,225	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00021
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 261123df0590e4881760d21501000000
	pid: 1641857
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,227	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00011
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: 9f6b751cd35dc23785f9f0e701000000
	pid: 1641157
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,229	ERROR tune_controller.py:1331 -- Trial task failed for trial train_fnn_b5994_00006
Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 2613, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/worker.py", line 863, in get_objects
    raise value
ray.exceptions.ActorDiedError: The actor died unexpectedly before finishing this task.
	class_name: ImplicitFunc
	actor_id: eb56c0d6660836d4b7f3ce5801000000
	pid: 1640778
	namespace: 79a23dd2-640c-47da-b413-6c6b5ec79bde
	ip: 10.112.2.49
The actor is dead because its worker process has died. Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
2024-07-10 10:20:38,290	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_10-20-31' in 0.0598s.
╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_01-47-53   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_01-47-53
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_01-47-49_405182_632180/artifacts/2024-07-10_01-47-53/train_fnn_2024-07-10_01-47-53/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_02-30-18   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_02-30-18
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_02-30-14_237914_632180/artifacts/2024-07-10_02-30-18/train_fnn_2024-07-10_02-30-18/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_03-18-34   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_03-18-34
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_03-18-29_794140_632180/artifacts/2024-07-10_03-18-34/train_fnn_2024-07-10_03-18-34/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_04-15-19   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_04-15-19
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_04-15-15_446078_632180/artifacts/2024-07-10_04-15-19/train_fnn_2024-07-10_04-15-19/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_05-14-54   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_05-14-54
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_05-14-50_337719_632180/artifacts/2024-07-10_05-14-54/train_fnn_2024-07-10_05-14-54/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_06-19-22   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_06-19-22
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_06-19-18_117870_632180/artifacts/2024-07-10_06-19-22/train_fnn_2024-07-10_06-19-22/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_07-35-06   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_07-35-06
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_07-35-01_433541_632180/artifacts/2024-07-10_07-35-06/train_fnn_2024-07-10_07-35-06/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_08-53-45   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_08-53-45
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_08-53-41_273452_632180/artifacts/2024-07-10_08-53-45/train_fnn_2024-07-10_08-53-45/driver_artifacts`

╭──────────────────────────────────────────────────────────────────╮
│ Configuration for experiment     train_fnn_2024-07-10_10-20-31   │
├──────────────────────────────────────────────────────────────────┤
│ Search algorithm                 BasicVariantGenerator           │
│ Scheduler                        AsyncHyperBandScheduler         │
│ Number of trials                 32                              │
╰──────────────────────────────────────────────────────────────────╯

View detailed results here: /zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/ray_results/train_fnn_2024-07-10_10-20-31
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts`
[33m(raylet)[0m Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffff577b3bbbfb8a4956c23b481101000000 Worker ID: 274b56719a2ee2e2fe2816c12ba61f03eca3a55df19b323ebceff5c3 Node ID: f056bea3e36640009c1c1787f65f955ec4e29e78b397d732a8560fbc Worker IP address: 10.112.2.49 Worker port: 33713 Worker PID: 1642147 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.

Trial train_fnn_b5994_00030 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00030_30_dropout_rate=0.3584,embedding_dim=20,hidden_dim=25,lr=0.0001,num_layers=3,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00002 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00002_2_dropout_rate=0.1247,embedding_dim=30,hidden_dim=15,lr=0.0090,num_layers=4,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00010 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00010_10_dropout_rate=0.5290,embedding_dim=5,hidden_dim=155,lr=0.0001,num_layers=4,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00000 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00000_0_dropout_rate=0.1091,embedding_dim=25,hidden_dim=65,lr=0.0007,num_layers=4,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00004 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00004_4_dropout_rate=0.2877,embedding_dim=20,hidden_dim=145,lr=0.0005,num_layers=3,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00019 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00019_19_dropout_rate=0.1696,embedding_dim=25,hidden_dim=15,lr=0.0001,num_layers=2,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00008 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00008_8_dropout_rate=0.2396,embedding_dim=10,hidden_dim=75,lr=0.0000,num_layers=4,weight_decay=0.0090_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00005 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00005_5_dropout_rate=0.0451,embedding_dim=5,hidden_dim=65,lr=0.0001,num_layers=5,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00027 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00027_27_dropout_rate=0.2096,embedding_dim=15,hidden_dim=55,lr=0.0000,num_layers=4,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00020 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00020_20_dropout_rate=0.4920,embedding_dim=20,hidden_dim=115,lr=0.0001,num_layers=4,weight_decay=0.0090_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00025 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00025_25_dropout_rate=0.1541,embedding_dim=5,hidden_dim=45,lr=0.0000,num_layers=1,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00022 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00022_22_dropout_rate=0.2858,embedding_dim=30,hidden_dim=85,lr=0.0005,num_layers=3,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00015 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00015_15_dropout_rate=0.0746,embedding_dim=15,hidden_dim=25,lr=0.0010,num_layers=1,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00016 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00016_16_dropout_rate=0.3938,embedding_dim=5,hidden_dim=135,lr=0.0003,num_layers=3,weight_decay=0.0090_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00013 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00013_13_dropout_rate=0.0726,embedding_dim=10,hidden_dim=45,lr=0.0009,num_layers=2,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00024 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00024_24_dropout_rate=0.1433,embedding_dim=20,hidden_dim=165,lr=0.0009,num_layers=2,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00007 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00007_7_dropout_rate=0.4599,embedding_dim=25,hidden_dim=65,lr=0.0000,num_layers=4,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00018 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00018_18_dropout_rate=0.1336,embedding_dim=25,hidden_dim=125,lr=0.0009,num_layers=3,weight_decay=0.0050_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00029 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00029_29_dropout_rate=0.3291,embedding_dim=15,hidden_dim=55,lr=0.0001,num_layers=5,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00026 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00026_26_dropout_rate=0.1394,embedding_dim=5,hidden_dim=45,lr=0.0000,num_layers=1,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00014 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00014_14_dropout_rate=0.1856,embedding_dim=30,hidden_dim=15,lr=0.0000,num_layers=1,weight_decay=0.0010_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00028 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00028_28_dropout_rate=0.2254,embedding_dim=30,hidden_dim=195,lr=0.0000,num_layers=2,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00003 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 6s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00003_3_dropout_rate=0.2934,embedding_dim=5,hidden_dim=115,lr=0.0003,num_layers=1,weight_decay=0.0010_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00001 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00001_1_dropout_rate=0.4777,embedding_dim=15,hidden_dim=185,lr=0.0001,num_layers=3,weight_decay=0.0005_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00017 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00017_17_dropout_rate=0.3142,embedding_dim=20,hidden_dim=185,lr=0.0001,num_layers=1,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00023 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00023_23_dropout_rate=0.1845,embedding_dim=15,hidden_dim=95,lr=0.0007,num_layers=4,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00012 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00012_12_dropout_rate=0.1174,embedding_dim=15,hidden_dim=5,lr=0.0007,num_layers=4,weight_decay=0.0000_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00009 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00009_9_dropout_rate=0.5173,embedding_dim=20,hidden_dim=175,lr=0.0010,num_layers=2,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00031 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00031_31_dropout_rate=0.3749,embedding_dim=5,hidden_dim=65,lr=0.0005,num_layers=2,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00021 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00021_21_dropout_rate=0.1331,embedding_dim=5,hidden_dim=65,lr=0.0010,num_layers=1,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00011 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00011_11_dropout_rate=0.4432,embedding_dim=25,hidden_dim=125,lr=0.0000,num_layers=1,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Trial train_fnn_b5994_00006 errored after 0 iterations at 2024-07-10 10:20:38. Total running time: 7s
Error file: /tmp/ray/session_2024-07-10_10-20-26_396888_632180/artifacts/2024-07-10_10-20-31/train_fnn_2024-07-10_10-20-31/driver_artifacts/train_fnn_b5994_00006_6_dropout_rate=0.0186,embedding_dim=5,hidden_dim=175,lr=0.0000,num_layers=2,weight_decay=0.0001_2024-07-10_10-20-31/error.txt

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py", line 358, in <module>
    prediction_data.to_csv(prediction_path, index=False)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/main.py", line 306, in main
    data_modeler = ModelData(ray_results_path=ray_results_path, verbose=0)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 289, in get_best_trial
    
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/tune/tune.py", line 1035, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [train_fnn_b5994_00000, train_fnn_b5994_00001, train_fnn_b5994_00002, train_fnn_b5994_00003, train_fnn_b5994_00004, train_fnn_b5994_00005, train_fnn_b5994_00006, train_fnn_b5994_00007, train_fnn_b5994_00008, train_fnn_b5994_00009, train_fnn_b5994_00010, train_fnn_b5994_00011, train_fnn_b5994_00012, train_fnn_b5994_00013, train_fnn_b5994_00014, train_fnn_b5994_00015, train_fnn_b5994_00016, train_fnn_b5994_00017, train_fnn_b5994_00018, train_fnn_b5994_00019, train_fnn_b5994_00020, train_fnn_b5994_00021, train_fnn_b5994_00022, train_fnn_b5994_00023, train_fnn_b5994_00024, train_fnn_b5994_00025, train_fnn_b5994_00026, train_fnn_b5994_00027, train_fnn_b5994_00028, train_fnn_b5994_00029, train_fnn_b5994_00030, train_fnn_b5994_00031])
[33m(raylet)[0m Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.[32m [repeated 31x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffff2434980b3fc8f8105eb12d2601000000 Worker ID: db60a6a83de5177a27f54709ba3d585c45ca1de5cea6b2799b3fcef5 Node ID: f056bea3e36640009c1c1787f65f955ec4e29e78b397d732a8560fbc Worker IP address: 10.112.2.49 Worker port: 44017 Worker PID: 1640521 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly. Worker exits with an exit code None. Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 1885, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1986, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1891, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1832, in ray._raylet.execute_task.function_executor
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 691, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 2283, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 2179, in ray._raylet.execute_task_with_cancellation_handler
  File "python/ray/_raylet.pyx", line 1834, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1835, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 2073, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 1064, in ray._raylet.store_task_errors
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 603, in temporary_actor_method
    raise RuntimeError(
RuntimeError: The actor with name ImplicitFunc failed to import on the worker. This may be because needed library dependencies are not installed in the worker environment:

Traceback (most recent call last):
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/venv/lib/python3.10/site-packages/ray/_private/function_manager.py", line 642, in _load_actor_class_from_gcs
    actor_class = pickle.loads(pickled_class)
  File "/zfs/projects/darc/wolee_edehaan_suzienoh-exploratory-ml/kevin/src/model_data_nn.py", line 273
    "lr": tune.loguniform(1e-5, 1e-3)
          ^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?

An unexpected internal error occurred while the worker was executing a task.[32m [repeated 31x across cluster][0m
INFO:postprocess_predictions.py:Post processing prediction files
INFO:postprocess_predictions.py:Saved the result file: result.csv
to the directory: kevin/output/prediction/monthly_new_vars
